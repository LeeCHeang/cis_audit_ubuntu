ID,Level,Profile,Domain,Title,Check_Type,Target,Parameters,Algorithm,Expected_Value
1.5.5,L1,"Server, Workstation",Initial Setup,Ensure Automatic Error Reporting is not enabled,multi_procedure,N/A,"{'steps':[{'name':'verify that the Apport Error Reporting Service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'dpkg-query -s apport &> /dev/null && grep -Psi -- \'^\\h*enabled\\h*=\\h*[^0]\\b\' /etc/default/apport'},{'name':'verify that the apport service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active apport.service | grep \'^active\''}]}",Null,
1.5.4,L1,"Server, Workstation",Initial Setup,Ensure prelink is not installed,command_output,"dpkg-query -s prelink &>/dev/null && echo ""prelink is installed"" ",,Null,
1.5.2,L1,"Server, Workstation",Initial Setup,Ensure ptrace_scope is restricted,execute_script,ensure_ptrace_scope_is_restricted.sh,,Contain,PASS
1.5.1,L1,"Server, Workstation",Initial Setup,Ensure address space layout randomization is enabled,execute_script,ensure_address_space_layout_randomization_is_enabled.sh,,Contain,PASS
1.4.2,L1,"Server, Workstation",Initial Setup,Ensure access to bootloader config is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)' /boot/grub/grub.cfg,,Exact,Access: (0600/-rw-------)  Uid: ( 0/ root) Gid: ( 0/ root)
1.3.1.2,L1,"Server, Workstation",Initial Setup,Ensure AppArmor is enabled in the bootloader configuration,multi_procedure,N/A,"{'steps':[{'name':'verify that all linux lines have the apparmor=1 parameter set','type':'command','algorithm':'Null','expected_value':'','command':'grep \""^\\s*linux\"" /boot/grub/grub.cfg | grep -v \""apparmor=1\""'},{'name':'verify that all linux lines have the security=apparmor parameter set:','type':'command','algorithm':'Null','expected_value':'','command':'grep \""^\\s*linux\"" /boot/grub/grub.cfg | grep -v \""security=apparmor\""'}]}",Null,
1.3.1.1,L1,"Server, Workstation",Initial Setup,Ensure latest versions of the apparmor packages are installed,multi_procedure,N/A,"{'steps':[{'name':'command to verify that apparmor is installed','type':'command','algorithm':'Contain','expected_value':'apparmor is installed','command':'dpkg-query -s apparmor &>/dev/null && echo \""apparmor is installed\""'},{'name':'command to verify that apparmor-utils is installed','type':'command','algorithm':'Contain','expected_value':'apparmor-utils is installed','command':'dpkg-query -s apparmor-utils &>/dev/null && echo \""apparmor-utils is installed\"" '},{'name':'command to verify apparmor is the latest version','type':'command','algorithm':'Null','expected_value':'','command':'apt list --upgradable 2>&1 | grep -P \'^apparmor\\b\''},{'name':'command to verify apparmor-utils is the latest version','type':'command','algorithm':'Null','expected_value':'','command':'apt list --upgradable 2>&1 | grep -P \'^apparmor-utils\\b\''}]}",Null,
1.1.2.7.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /var/log/audit partition,command_output,findmnt -kn /var/log/audit | grep -v noexec,,Null,
1.1.2.7.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var/log/audit partition,command_output,findmnt -kn /var/log/audit | grep -v nosuid,,Null,
1.1.2.7.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var/log/audit partition,command_output,findmnt -kn /var/log/audit | grep -v nodev,,Null,
1.1.2.6.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /var/log partition,command_output,findmnt -kn /var/log | grep -v noexec,,Null,
1.1.2.6.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var/log partition,command_output,findmnt -kn /var/log | grep -v nosuid,,Null,
1.1.2.6.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var/log partition,command_output,findmnt -kn /var/log | grep -v nodev,,Null,
1.1.2.5.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /var/tmp partition,command_output,findmnt -kn /var/tmp | grep -v noexec,,Null,
1.1.2.5.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var/tmp partition,command_output,findmnt -kn /var/tmp | grep -v nosuid,,Null,
1.1.2.5.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var/tmp partition,command_output,findmnt -kn /var/tmp | grep -v nodev,,Null,
1.1.2.4.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var partition,command_output,findmnt -kn /var | grep -v nosuid,,Null,
1.1.2.4.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var partition,command_output,findmnt -kn /var | grep -v nodev,,Null,
1.1.2.3.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /home partition,command_output,findmnt -kn /home | grep -v nosuid,,Null,
1.1.2.3.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /home partition,command_output,findmnt -kn /home | grep -v nodev,,Null,
1.1.2.2.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /dev/shm partition,command_output,findmnt -kn /dev/shm | grep -v 'noexec',,Null,
1.1.2.2.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /dev/shm partition,command_output,findmnt -kn /dev/shm | grep -v 'nosuid',,Null,
1.1.2.2.1,L1,"Server, Workstation",Initial Setup,Ensure /dev/shm is a separate partition,command_output,findmnt -kn /dev/shm,,Exact,"/dev/shm   tmpfs  tmpfs  rw,nosuid,nodev,noexec,relatime,seclabel"
1.1.2.1.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /tmp partition,command_output,findmnt -kn /tmp | grep -v noexec,,Null,
1.1.2.1.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /tmp partition,command_output,findmnt -kn /tmp | grep -v nosuid,,Null,
1.1.2.1.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /tmp partition,command_output,findmnt -kn /tmp | grep -v nodev,,Null,
1.1.2.1.1,L1,"Server, Workstation",Initial Setup,Ensure /tmp is a separate partition,multi_procedure,N/A,"{'steps': [{'name': 'Verify the output shows that /tmp is mounted', 'type': 'command', 'algorithm': 'Contain', 'expected_value': '/tmp   tmpfs  tmpfs  rw,nosuid,nodev,noexec', 'command': 'findmnt -kn /tmp'}, {'name': 'Ensure that systemd will mount the /tmp partition at boot time.', 'type': 'command', 'algorithm': 'Exact', 'expected_value': 'generated', 'command': 'systemctl is-enabled tmp.mount'}]}",Null,
1.1.1.9,L1,Server,Initial Setup,Ensure usb-storage kernel module is not available,multi_procedure,N/A,"{'steps': [{'name': 'Check kernel module is not available', 'type': 'script', 'algorithm': 'Null', 'expected_value': '', 'target_script': 'ensure_kernel_module_is_not_available.sh', 'script_params': ['usb-storage', 'drivers']}, {'name': 'Check kernel module is not loaded', 'type': 'command', 'algorithm': 'Null', 'expected_value': '', 'command': 'lsmod | grep -P -- \'usb(_|-)storage\''}, {'name': 'Check kernel module is not loadable', 'type': 'command', 'algorithm': 'Contain', 'expected_value': 'se;install usb_storage /bin/trublacklist usb_storage;install usb_storage /bin/fale', 'command': ' modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+usb_storage\\b\''}]}",,
1.1.1.6,L2,"Server, Workstation",Initial Setup,Ensure overlay kernel module is not available,multi_procedure,N/A,"{'steps': [{'name': 'Check kernel module is not available', 'type': 'script', 'algorithm': 'Null', 'expected_value': '', 'target_script': 'ensure_kernel_module_is_not_available.sh', 'script_params': ['overlayfs']}, {'name': 'Check kernel module is not loaded', 'type': 'command', 'algorithm': 'Null', 'expected_value': '', 'command': 'lsmod | grep \'overlay\''}, {'name': 'Check kernel module is not loadable', 'type': 'command', 'algorithm': 'Contain', 'expected_value': 'blacklist overlay ;install overlay /bin/false ;install overlay /bin/true', 'command': 'modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+overlay\\b\''}]}",,
1.1.1.5,L1,"Server, Workstation",Initial Setup,Ensure jffs2 kernel module is not available,multi_procedure,N/A,"{'steps': [{'name': 'Check kernel module is not available', 'type': 'script', 'algorithm': 'Null', 'expected_value': '', 'target_script': 'ensure_kernel_module_is_not_available.sh', 'script_params': ['jffs2']}, {'name': 'Check kernel module is not loaded', 'type': 'command', 'algorithm': 'Null', 'expected_value': '', 'command': 'lsmod | grep \'jffs2\''}, {'name': 'Check kernel module is not loadable', 'type': 'command', 'algorithm': 'Contain', 'expected_value': 'blacklist jffs2;install jffs2 /bin/false;install jffs2 /bin/true', 'command': 'modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+jffs2\\b\''}]}",,
1.1.1.4,L1,"Server, Workstation",Initial Setup,Ensure hfsplus kernel module is not available,multi_procedure,N/A,"{'steps': [{'name': 'Determine hfsplus if it available on the system', 'type': 'script', 'algorithm': 'Null', 'expected_value': '', 'target_script': 'ensure_kernel_module_is_not_available.sh', 'script_params': ['hfsplus']}, {'name': 'Check kernel module is not loaded', 'type': 'command', 'algorithm': 'Null', 'expected_value': '', 'command': 'lsmod | grep \'hfsplus\''}, {'name': 'Check kernel module is not loadable', 'type': 'command', 'algorithm': 'Contain', 'expected_value': 'blacklist hfs;install hfs /bin/false;install hfs /bin/true', 'command': 'modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+hfsplus\\b\''}]}",,
1.1.1.3,L1,"Server, Workstation",Initial Setup,Ensure hfs kernel module is not available,multi_procedure,N/A,"{'steps': [{'name': 'Determine if hfs is available on the system', 'type': 'script', 'algorithm': 'Null', 'expected_value': '', 'target_script': 'kernel_config_parameter.sh', 'script_params': ['hfs']}, {'name': 'Check kernel module is not loaded', 'type': 'command', 'algorithm': 'Null', 'expected_value': '', 'command': 'lsmod | grep \'hfs\''}, {'name': 'Check kernel module is not loadable', 'type': 'command', 'algorithm': 'Contain', 'expected_value': 'blacklist hfs;install hfs /bin/false;install hfs /bin/true', 'command': 'modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+hfs\\b\''}]}",,
1.1.1.2,L1,"Server, Workstation",Initial Setup,Ensure freevxfs kernel module is not available,multi_procedure,N/A,"{'steps': [{'name': 'Check kernel module is not loaded', 'type': 'command', 'algorithm': 'Null', 'expected_value': '', 'command': 'lsmod | grep \'freevxfs\''}, {'name': 'Check kernel module is not loadable', 'type': 'command', 'algorithm': 'Contain', 'expected_value': 'blacklist freevxfs;install freevxfs /bin/false;install freevxfs /bin/true', 'command': 'modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+freevxfs\\b\''}]}",,
1.1.1.1,L1,"Server, Workstation",Initial Setup,Esure cramfs kernel module is not available,multi_procedure,N/A,"{'steps': [{'name': 'Determine if hfs is available on the system', 'type': 'script', 'algorithm': 'Null', 'expected_value': '', 'target_script': 'kernel_config_parameter.sh', 'script_params': ['cramfs']}, {'name': 'Check kernel module is not loaded', 'type': 'command', 'algorithm': 'Null', 'expected_value': '', 'command': 'lsmod | grep \'cramfs\''}, {'name': 'Check kernel module is not loadable', 'type': 'command', 'algorithm': 'Contain', 'expected_value': 'blacklist cramfs;install cramfs /bin/false;install cramfs /bin/true', 'command': 'modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+cramfs\\b\''}]}",,