ID,Level,Profile,Domain,Title,Check_Type,Target,Parameters,Algorithm,Expected_Value
1.1.1.1,L1,"Server, Workstation",Initial Setup,Ensure cramfs kernel module is not available,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'Determine if the cramfs kernel module is available on the system', 'type_handler': 'execute_script', 'target': 'ensure_kernel_module_is_not_available.sh', 'parameters': ['cramfs'], 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'vverify the cramfs kernel module is not loaded', 'type_handler': 'command_output', 'target': 'lsmod | grep ""cramfs""', 'algorithm': 'Null'}, {'title': 'verify the cramfs kernel module is not loadable', 'type_handler': 'command_output', 'target': 'modprobe --showconfig | grep -P -- ""\\b(install|blacklist)\\h+cramfs\\b""', 'algorithm': 'Contain', 'expected_value': 'blacklist cramfs;install cramfs /bin/false;install cramfs /bin/true'}]}]}",,
1.1.1.2,L1,"Server, Workstation",Initial Setup,Ensure freevxfs kernel module is not available,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'Determine if the freevxfs kernel module is available on the system', 'type_handler': 'execute_script', 'target': 'ensure_kernel_module_is_not_available.sh', 'parameters': ['freevxfs'], 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify the freevxfs kernel module is not loaded', 'type_handler': 'command_output', 'target': 'lsmod | grep ""freevxfs""', 'algorithm': 'Null'}, {'title': 'verify the freevxfs kernel module is not loadable', 'type_handler': 'command_output', 'target': 'modprobe --showconfig | grep -P -- ""\\b(install|blacklist)\\h+freevxfs\\b""', 'algorithm': 'Contain', 'expected_value': 'blacklist freevxfs;install freevxfs /bin/false;install freevxfs /bin/true'}]}]}",,
1.1.1.3,L1,"Server, Workstation",Initial Setup,Ensure hfs kernel module is not available,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'Determine if the hfs kernel module is available on the system', 'type_handler': 'execute_script', 'target': 'ensure_kernel_module_is_not_available.sh', 'parameters': ['hfs'], 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify the hfs kernel module is not loaded', 'type_handler': 'command_output', 'target': 'lsmod | grep ""hfs""', 'algorithm': 'Null'}, {'title': 'verify the hfs kernel module is not loadable', 'type_handler': 'command_output', 'target': 'modprobe --showconfig | grep -P -- ""\\b(install|blacklist)\\h+hfs\\b""', 'algorithm': 'Contain', 'expected_value': 'blacklist hfs;install hfs /bin/false;install hfs /bin/true'}]}]}",,
1.1.1.4,L1,"Server, Workstation",Initial Setup,Ensure hfsplus kernel module is not available,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'Determine if the hfsplus kernel module is available on the system', 'type_handler': 'execute_script', 'target': 'ensure_kernel_module_is_not_available.sh', 'parameters': ['hfsplus'], 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify the hfsplus kernel module is not loaded', 'type_handler': 'command_output', 'target': 'lsmod | grep ""hfsplus""', 'algorithm': 'Null'}, {'title': 'verify the hfsplus kernel module is not loadable', 'type_handler': 'command_output', 'target': 'modprobe --showconfig | grep -P -- ""\\b(install|blacklist)\\h+hfsplus\\b""', 'algorithm': 'Contain', 'expected_value': 'blacklist hfsplus;install hfsplus /bin/false;install hfsplus /bin/true'}]}]}",,
1.1.1.5,L1,"Server, Workstation",Initial Setup,Ensure jffs2 kernel module is not available,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'Determine if the jffs2 kernel module is available on the system', 'type_handler': 'execute_script', 'target': 'ensure_kernel_module_is_not_available.sh', 'parameters': ['jffs2'], 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify the jffs2 kernel module is not loaded', 'type_handler': 'command_output', 'target': 'lsmod | grep ""jffs2""', 'algorithm': 'Null'}, {'title': 'verify the jffs2 kernel module is not loadable', 'type_handler': 'command_output', 'target': 'modprobe --showconfig | grep -P -- ""\\b(install|blacklist)\\h+jffs2\\b""', 'algorithm': 'Contain', 'expected_value': 'blacklist jffs2;install jffs2 /bin/false;install jffs2 /bin/true'}]}]}",,
1.1.1.9,L1,Server,Initial Setup,Ensure usb-storage kernel module is not available,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'Determine if the usb-storage kernel module is available on the system', 'type_handler': 'execute_script', 'target': 'ensure_kernel_module_is_not_available.sh', 'parameters': ['usb-storage', 'drivers'], 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify the usb-storage kernel module is not loaded', 'type_handler': 'command_output', 'target': 'lsmod | grep -P -- ""usb(_|-)storage""', 'algorithm': 'Null'}, {'title': 'verify the usb-storage kernel module is not loadable', 'type_handler': 'command_output', 'target': 'modprobe --showconfig | grep -P -- ""\\b(install|blacklist)\\h+usb_storage\\b""', 'algorithm': 'Contain', 'expected_value': 'blacklist usb_storage;install usb_storage /bin/false;install usb_storage /bin/true'}]}]}",,
1.1.2.1.1,L1,"Server, Workstation",Initial Setup,Ensure /tmp is a separate partition,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify the output shows that /tmp is mounted', 'type_handler': 'command_output', 'target': 'findmnt -kn /tmp', 'algorithm': 'Contain', 'expected_value': '/tmp   tmpfs  tmpfs  rw,nosuid,nodev,noexec'}, {'title': 'Ensure that systemd will mount the /tmp partition at boot time', 'type_handler': 'command_output', 'target': 'systemctl is-enabled tmp.mount', 'algorithm': 'Exact', 'expected_value': 'generated'}]}",,
1.1.2.1.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /tmp partition,command_output,findmnt -kn /tmp | grep -v nodev,'',Null,
1.1.2.1.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /tmp partition,command_output,findmnt -kn /tmp | grep -v nosuid,'',Null,
1.1.2.1.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /tmp partition,command_output,findmnt -kn /tmp | grep -v noexec,'',Null,
1.1.2.2.1,L1,"Server, Workstation",Initial Setup,Ensure /dev/shm is a separate partition,command_output,findmnt -kn /dev/shm,'',Contain,"/dev/shm   tmpfs  tmpfs  rw,nosuid,nodev,noexec,relatime,seclabel"
1.1.2.2.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /dev/shm partition,command_output,findmnt -kn /dev/shm | grep -v 'nodev','',Null,
1.1.2.2.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /dev/shm partition,command_output,findmnt -kn /dev/shm | grep -v 'nosuid','',Null,
1.1.2.2.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /dev/shm partition,command_output,findmnt -kn /dev/shm | grep -v 'noexec','',Null,
1.1.2.3.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /home partition,command_output,findmnt -kn /home | grep -v nodev,'',Null,
1.1.2.3.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /home partition,command_output,findmnt -kn /home | grep -v nosuid,'',Null,
1.1.2.4.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var partition,command_output,findmnt -kn /var | grep -v nodev,'',Null,
1.1.2.4.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var partition,command_output,findmnt -kn /var | grep -v nosuid,'',Null,
1.1.2.5.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var/tmp partition,command_output,findmnt -kn /var/tmp | grep -v nodev,'',Null,
1.1.2.5.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var/tmp partition,command_output,findmnt -kn /var/tmp | grep -v nosuid,'',Null,
1.1.2.5.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /var/tmp partition,command_output,findmnt -kn /var/tmp | grep -v noexec,'',Null,
1.1.2.6.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var/log partition,command_output,findmnt -kn /var/log | grep -v nodev,'',Null,
1.1.2.6.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var/log partition,command_output,findmnt -kn /var/log | grep -v nosuid,'',Null,
1.1.2.6.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /var/log partition,command_output,findmnt -kn /var/log | grep -v noexec,'',Null,
1.1.2.7.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var/log/audit partition,command_output,findmnt -kn /var/log/audit | grep -v nodev,'',Null,
1.1.2.7.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var/log/audit partition,command_output,findmnt -kn /var/log/audit | grep -v nosuid,'',Null,
1.1.2.7.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /var/log/audit partition,command_output,findmnt -kn /var/log/audit | grep -v noexec,'',Null,
1.3.1.1,L1,"Server, Workstation",Initial Setup,Ensure latest versions of the apparmor packages are installed,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify that apparmor is installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s apparmor &>/dev/null && echo ""apparmor is installed""', 'algorithm': 'Exact', 'expected_value': 'apparmor is installed'}, {'title': 'verify that apparmor-utils is installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s apparmor-utils &>/dev/null && echo ""apparmor-utils is installed"" ', 'algorithm': 'Exact', 'expected_value': 'apparmor-utils is installed'}, {'title': 'verify apparmor is the latest version', 'type_handler': 'command_output', 'target': 'apt list --upgradable 2>&1 | grep -P ""^apparmor\\b""', 'algorithm': 'Null'}, {'title': 'verify apparmor-utils is the latest version:', 'type_handler': 'command_output', 'target': 'apt list --upgradable 2>&1 | grep -P ""^apparmor-utils\\b""', 'algorithm': 'Null'}]}",,
1.3.1.2,L1,"Server, Workstation",Initial Setup,Ensure AppArmor is enabled in the bootloader configuration,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify that all linux lines have the apparmor=1 parameter set', 'type_handler': 'command_output', 'target': 'grep ""^\\s*linux"" /boot/grub/grub.cfg | grep -v ""apparmor=1""', 'algorithm': 'Null'}, {'title': 'verify that all linux lines have the security=apparmor parameter set', 'type_handler': 'command_output', 'target': 'grep ""^\\s*linux"" /boot/grub/grub.cfg | grep -v ""security=apparmor""', 'algorithm': 'Null'}]}",,
1.3.1.3,L1,"Server, Workstation",Initial Setup,Ensure all AppArmor Profiles are not disabled,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify that profiles are loaded, and are in either enforce or complain mode', 'type_handler': 'command_output', 'target': 'sudo apparmor_status | grep profiles | awk \'/profiles are loaded/{l=$1} /enforce mode/{e=$1} /complain mode/{c=$1} END{print (l>0 && e+c==l) ? ""PASS"" : ""FAIL""}\'', 'algorithm': 'Exact', 'expected_value': 'PASS'}, {'title': 'verify no processes are unconfined', 'type_handler': 'command_output', 'target': 'sudo apparmor_status | grep processes | awk \'/processes are loaded/{l=$1} /enforce mode/{e=$1} /complain mode/{c=$1} END{print (l>0 && e+c==l) ? ""PASS"" : ""FAIL""}\'', 'algorithm': 'Exact', 'expected_value': 'PASS'}]}",,
1.4.2,L1,"Server, Workstation",Initial Setup,Ensure access to bootloader config is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)' /boot/grub/grub.cfg,'',Exact,Access: (0600/-rw-------)  Uid: ( 0/ root) Gid: ( 0/ root)
1.5.1,L1,"Server, Workstation",Initial Setup,Ensure address space layout randomization is enabled,execute_script,ensure_address_space_layout_randomization_is_enabled.sh,'',Contain,PASS
1.5.2,L1,"Server, Workstation",Initial Setup,Ensure ptrace_scope is restricted,execute_script,ensure_ptrace_scope_is_resticted.sh,'',Contain,PASS
1.5.3,L1,"Server, Workstation",Initial Setup,Ensure core dumps are restricted,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify output matches', 'type_handler': 'command_output', 'target': 'grep -Ps -- ""^\\h*\\*\\h+hard\\h+core\\h+0\\b"" /etc/security/limits.conf /etc/security/limits.d/*', 'algorithm': 'Contain', 'expected_value': '* hard core 0'}, {'title': 'verify fs.suid_dumpable = 0 the following kernel parameter is set in the running configuration and correctly loaded from a kernel parameter configuration file', 'type_handler': 'execute_script', 'target': 'ensure_core_dumps_are_restricted_check1_kernel_parameter.sh', 'algorithm': 'Contain', 'expected_value': 'PASS'}, {'logic': 'OR', 'steps': [{'title': 'check if systemd-coredump is installed', 'type_handler': 'command_output', 'target': 'systemctl list-unit-files | grep coredump', 'algorithm': 'Null', 'pass_stop_check': True}, {'logic': 'AND', 'steps': [{'title': 'verify Storage=none', 'type_handler': 'command_output', 'target': 'grep -Psi -- ""^\\s*Storage\\s*=\\s*none\\s*$"" /etc/systemd/coredump.conf', 'algorithm': 'Exact', 'expected_value': 'Storage=none'}, {'title': 'verify ProcessSizeMax=0', 'type_handler': 'command_output', 'target': 'grep -Psi -- ""^\\s*ProcessSizeMax\\s*=\\s*0"" /etc/systemd/coredump.conf', 'algorithm': 'Exact', 'expected_value': 'ProcessSizeMax=0'}]}]}]}",,
1.5.4,L1,"Server, Workstation",Initial Setup,Ensure prelink is not installed,command_output,"dpkg-query -s prelink &>/dev/null && echo ""prelink is installed"" ",'',Null,
1.5.5,L1,"Server, Workstation",Initial Setup,Ensure Automatic Error Reporting is not enabled,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'Verify that the Apport Error Reporting Service is not enabled', 'type_handler': 'command_output', 'target': 'dpkg-query -s apport &> /dev/null && grep -Psi -- ""^\\h*enabled\\h*=\\h*[^0]\\b"" /etc/default/apport', 'algorithm': 'Null'}, {'title': 'Verify that the apport service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active apport.service | grep ""^active""', 'algorithm': 'Null'}]}",,
1.6.1,L1,"Server, Workstation",Initial Setup,Ensure /etc/motd is configured,execute_script,ensure_etc_motd_is_configured.sh,'',Contain,PASS
2.1.1,L1,Server,Services,Ensure autofs services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': ' verify autofs is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s autofs &>/dev/null && echo ""autofs is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify autofs.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled autofs.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify the autofs.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active autofs.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.10,L1,"Server, Workstation",Services,Ensure nis server services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify ypserv is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s ypserv &>/dev/null && echo ""ypserv is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify ypserv.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled ypserv.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': ' ypserv.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active ypserv.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.11,L1,Server,Services,Ensure print server services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify cups is not Installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s cups &>/dev/null && echo ""cups is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify the cups.socket and cups.service are not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled cups.socket cups.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify the cups.socket and cups.service are not active', 'type_handler': 'command_output', 'target': 'systemctl is-active cups.socket cups.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.12,L1,"Server, Workstation",Services,Ensure rpcbind services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify rpcbind package is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s rpcbind &>/dev/null && echo ""rpcbind is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify rpcbind.socket and rpcbind.service are not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled rpcbind.socket rpcbind.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'erify rpcbind.socket and rpcbind.service are not active', 'type_handler': 'command_output', 'target': 'systemctl is-active rpcbind.socket rpcbind.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.13,L1,"Server, Workstation",Services,Ensure rsync services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify rsync is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s rsync &>/dev/null && echo ""rsync is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify rsync.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled rsync.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify rsync.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active rsync.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.14,L1,"Server, Workstation",Services,Ensure samba file server services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify samba is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s samba &>/dev/null && echo ""samba is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify smbd.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled smbd.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify the smbd.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active smbd.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.15,L1,"Server, Workstation",Services,Ensure snmp services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify snmpd is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s snmpd &>/dev/null && echo ""snmpd is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify the snmpd.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled snmpd.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify the snmpd.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active snmpd.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.16,L1,"Server, Workstation",Services,Ensure tftp server services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify tftpd-hpa is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s tftpd-hpa &>/dev/null && echo ""tftpd-hpa is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify tftpd-hpa.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled tftpd-hpa.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify the tftpd-hpa.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active tftpd-hpa.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.17,L1,"Server, Workstation",Services,Ensure web proxy server services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'logic': 'AND', 'steps': [{'title': ' verify squid is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s squid &>/dev/null && echo ""squid is installed""', 'algorithm': 'Null'}, {'title': 'verify squid-openssl is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s squid-openssl &>/dev/null && echo ""squid is installed""', 'algorithm': 'Null'}]}, {'logic': 'AND', 'steps': [{'title': 'verify squid.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled squid.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify the squid.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active squid.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.18,L1,"Server, Workstation",Services,Ensure web server services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'logic': 'AND', 'steps': [{'title': 'verify apache2 is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s apache2 &>/dev/null && echo ""apache2 is installed""', 'algorithm': 'Null'}, {'title': 'verify nginx is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s nginx &>/dev/null && echo ""nginx is installed""', 'algorithm': 'Null'}]}, {'logic': 'AND', 'steps': [{'title': ' verify apache2.socket, apache2.service, and nginx.service are not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled apache2.socket apache2.service nginx.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify apache2.socket, apache2.service, and nginx.service are not active', 'type_handler': 'command_output', 'target': 'systemctl is-active apache2.socket apache2.service nginx.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.19,L1,"Server, Workstation",Services,Ensure xinetd services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify the xinetd package is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s xinetd &>/dev/null && echo ""xinetd is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify xinetd.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled xinetd.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify xinetd.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active xinetd.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.2,L1,"Server, Workstation",Services,Ensure avahi daemon services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify avahi-daemon is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s avahi-daemon &>/dev/null && echo ""avahi-daemon is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify avahi-daemon.socket and avahi-daemon.service are not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled avahi-daemon.socket avahi-daemon.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify avahi-daemon.socket and avahi-daemon.service are not active', 'type_handler': 'command_output', 'target': 'systemctl is-active avahi-daemon.socket avahi-daemon.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.21,L1,"Server, Workstation",Services,Ensure mail transfer agents are configured for local-only mode,execute_script,ensure_mail_transfer_agents_are_configured_for_localonly_mode.sh,'',Contain,PASS
2.1.3,L1,"Server, Workstation",Services,Ensure dhcp server services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify isc-dhcp-server is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s isc-dhcp-server &>/dev/null && echo ""isc-dhcp-server is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify isc-dhcp-server.service and isc-dhcp-server6.service are not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled isc-dhcp-server.service isc-dhcp-server6.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify isc-dhcp-server.service and isc-dhcp-server6.service are not active', 'type_handler': 'command_output', 'target': 'systemctl is-active isc-dhcp-server.service isc-dhcp-server6.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}]}",,
2.1.4,L1,"Server, Workstation",Services,Ensure dns server services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify bind9 is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s bind9 &>/dev/null && echo ""bind9 is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify named.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled named.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify the named.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active named.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.5,L1,"Server, Workstation",Services,Ensure dnsmasq services are not in use,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify dnsmasq is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s dnsmasq &>/dev/null && echo ""dnsmasq is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify dnsmasq.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled dnsmasq.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify the dnsmasq.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active dnsmasq.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.6,L1,"Server, Workstation",Services,Ensure ftp server services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify vsftpd is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s vsftpd &>/dev/null && echo ""vsftpd is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify vsftpd service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled vsftpd.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify the vsftpd service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active vsftpd.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.7,L1,"Server, Workstation",Services,Ensure ldap server services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify slapd is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s slapd &>/dev/null && echo ""slapd is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify slapd.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled slapd.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify slapd.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active slapd.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.8,L1,"Server, Workstation",Services,Ensure message access server services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'logic': 'AND', 'steps': [{'title': 'verify dovecot-imapd', 'type_handler': 'command_output', 'target': 'dpkg-query -s dovecot-imapd &>/dev/null && echo ""dovecot-imapd is installed""', 'algorithm': 'Null'}, {'title': 'verify dovecot-pop3d are not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s dovecot-pop3d &>/dev/null && echo ""dovecot-pop3d is installed""', 'algorithm': 'Null'}]}, {'logic': 'AND', 'steps': [{'title': 'verify dovecot.socket and dovecot.service are not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled dovecot.socket dovecot.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify dovecot.socket and dovecot.service are not active', 'type_handler': 'command_output', 'target': 'systemctl is-active dovecot.socket dovecot.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.1.9,L1,"Server, Workstation",Services,Ensure network file system services are not in use,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify nfs-kernel-server is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s nfs-kernel-server &>/dev/null && echo ""nfs-kernel-server is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify that the nfs-server.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled nfs-server.service 2>/dev/null | grep ""enabled""', 'algorithm': 'Null'}, {'title': 'verify the nfs-server.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active nfs-server.service 2>/dev/null | grep ""^active""', 'algorithm': 'Null'}]}]}",,
2.2.1,L1,"Server, Workstation",Services,Ensure nis client is not installed,command_output,"dpkg-query -s nis &>/dev/null && echo ""nis is installed""",'',Null,
2.2.2,L1,"Server, Workstation",Services,Ensure rsh client is not installed,command_output,"dpkg-query -s rsh-client &>/dev/null && echo ""rsh-client is installed""",'',Null,
2.2.3,L1,"Server, Workstation",Services,Ensure talk client is not installed,command_output,"dpkg-query -s talk &>/dev/null && echo ""talk is installed""",'',Null,
2.2.4,L1,"Server, Workstation",Services,Ensure telnet client is not installed,command_output,"dpkg-query -s telnet &>/dev/null && echo ""telnet is installed""",'',Null,
2.2.5,L1,"Server, Workstation",Services,Ensure ldap client is not installed,command_output,"dpkg-query -s ldap-utils &>/dev/null && echo ""ldap-utils is installed""",'',Null,
2.2.6,L1,"Server, Workstation",Services,Ensure ftp client is not installed,command_output,"dpkg-query -s ftp &>/dev/null && echo ""ftp is installed""",'',Null,
2.3.1.1,L1,"Server, Workstation",Services,Ensure a single time synchronization daemon is in use,execute_script,ensure_a_single_time_synchronization_daemon_is_in_use.sh,'',Contain,PASS
2.3.3.1,L1,"Server, Workstation",Services,Ensure chrony is configured with authorized timeserver,execute_script,ensure_chrony_is_configured_with_authorized_timeserver.sh,'',Contain,PASS
2.3.3.2,L1,"Server, Workstation",Services,Ensure chrony is running as user _chrony,command_output,"ps -ef | awk '(/[c]hronyd/ && $1!=""_chrony"") { print $1 }'",'',Null,
2.3.3.3,L1,"Server, Workstation",Services,Ensure chrony is enabled and running,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify that the chrony service is enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled chrony.service', 'algorithm': 'Exact', 'expected_value': 'enabled'}, {'title': 'verify that the chrony service is active', 'type_handler': 'command_output', 'target': 'systemctl is-active chrony.service', 'algorithm': 'Exact', 'expected_value': 'active'}]}",,
2.4.1.1,L1,"Server, Workstation",Services,Ensure cron daemon is enabled and active,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify cron is enabled', 'type_handler': 'command_output', 'target': 'systemctl list-unit-files | awk ""$1~/^crond?\\.service/{print $2}""', 'algorithm': 'Exact', 'expected_value': 'enabled'}, {'title': 'verify that cron is active', 'type_handler': 'command_output', 'target': 'systemctl list-units | awk ""$1~/^crond?\\.service/{print $3}""', 'algorithm': 'Exact', 'expected_value': 'active'}]}",,
2.4.1.2,L1,"Server, Workstation",Services,Ensure access to /etc/crontab is configured,command_output,stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/crontab,'',Exact,Access: (600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)
2.4.1.3,L1,"Server, Workstation",Services,Ensure access to /etc/cron.hourly is configured,command_output,stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.hourly/,'',Exact,Access: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)
2.4.1.4,L1,"Server, Workstation",Services,Ensure access to /etc/cron.daily is configured,command_output,stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.daily/,'',Exact,Access: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)
2.4.1.5,L1,"Server, Workstation",Services,Ensure access to /etc/cron.weekly is configured,command_output,stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.weekly/,'',Exact,Access: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)
2.4.1.6,L1,"Server, Workstation",Services,Ensure access to /etc/cron.monthly is configured,command_output,stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.monthly/,'',Contain,Access: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)
2.4.1.7,L1,"Server, Workstation",Services,Ensure access to /etc/cron.yearly is configured,command_output,stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.yearly/,'',Exact,Access: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)
2.4.1.8,L1,"Server, Workstation",Services,Ensure access to /etc/cron.d is configured,command_output,stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.d/,'',Exact,Access: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)
2.4.1.9,L1,"Server, Workstation",Services,Ensure access to crontab is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify /etc/cron.allow:  Exists Is mode 0640 or more restrictive Is owned by the user root Is group owned by the group root - OR - the group crontab', 'type_handler': 'command_output', 'target': 'stat -Lc ""Access: (%a/%A) Owner: (%U) Group: (%G)"" /etc/cron.allow', 'algorithm': 'Exact', 'expected_value': 'Access: (640/-rw-r-----) Owner: (root) Group: (root);Access: (640/-rw-r-----) Owner: (root) Group: (crontab)'}, {'title': 'Verify either nothing is returned - OR - returned value is one of the following:', 'type_handler': 'command_output', 'target': '[ -e ""/etc/cron.deny"" ] && stat -Lc ""Access: (%a/%A) Owner: (%U) Group: (%G)"" /etc/cron.deny', 'algorithm': 'Exact', 'expected_value': ' ;Access: (640/-rw-r-----) Owner: (root) Group: (root);Access: (640/-rw-r-----) Owner: (root) Group: (crontab)'}]}",,
2.4.2.1,L1,"Server, Workstation",Services,Ensure access to at is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'Verify mode is 640 or more restrictive, owner is root, and group is daemon or root', 'type_handler': 'command_output', 'target': 'stat -Lc ""Access: (%a/%A) Owner: (%U) Group: (%G)"" /etc/at.allow', 'algorithm': 'Exact', 'expected_value': 'Access: (640/-rw-r-----) Owner: (root) Group: (daemon);Access: (640/-rw-r-----) Owner: (root) Group: (root)'}, {'title': 'verify mode is 640 or more restrictive, owner is root, and group is daemon or root', 'type_handler': 'command_output', 'target': '[ -e ""/etc/at.deny"" ] && stat -Lc ""Access: (%a/%A) Owner: (%U) Group: (%G)"" /etc/at.deny', 'algorithm': 'Exact', 'expected_value': ' ;Access: (640/-rw-r-----) Owner: (root) Group: (root);Access: (640/-rw-r-----) Owner: (root) Group: (daemon)'}]}",,
3.1.2,L1,Server,Network Configuration,Ensure wireless interfaces are not available,execute_script,ensure_wireless_intrfaces_are_not_availabe.sh,'',Exact,PASS
3.1.3,L1,Server,Network Configuration,Ensure bluetooth services are not in use,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify the bluez package is not installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s bluez &>/dev/null && echo ""bluez is installed"" ', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify bluetooth.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled bluetooth.service 2>/dev/null | grep \'enabled\'', 'algorithm': 'Null'}, {'title': 'verify bluetooth.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active bluetooth.service 2>/dev/null | grep \'^active\'', 'algorithm': 'Null'}]}]}",,
3.3.1,L1,"Server, Workstation",Network Configuration,Ensure ip forwarding is disabled,execute_script,kernel_config_parameter.sh,"['net.ipv4.ip_forward=0', 'net.ipv6.conf.all.forwarding=0']",Contain,PASS
3.3.10,L1,"Server, Workstation",Network Configuration,Ensure tcp syn cookies is enabled,execute_script,kernel_config_parameter.sh,['net.ipv4.tcp_syncookies=1'],Contain,PASS
3.3.11,L1,"Server, Workstation",Network Configuration,Ensure ipv6 router advertisements are not accepted,execute_script,kernel_config_parameter.sh,"['net.ipv6.conf.all.accept_ra=0', 'net.ipv6.conf.default.accept_ra=0']",Contain,PASS
3.3.2,L1,"Server, Workstation",Network Configuration,Ensure packet redirect sending is disabled,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.send_redirects=0', 'net.ipv4.conf.default.send_redirects=0']",Contain,PASS
3.3.3,L1,"Server, Workstation",Network Configuration,Ensure bogus icmp responses are ignored,execute_script,kernel_config_parameter.sh,['net.ipv4.icmp_ignore_bogus_error_responses=1'],Contain,PASS
3.3.4,L1,"Server, Workstation",Network Configuration,Ensure broadcast icmp requests are ignored,execute_script,kernel_config_parameter.sh,['net.ipv4.icmp_echo_ignore_broadcasts=1'],Contain,PASS
3.3.5,L1,"Server, Workstation",Network Configuration,Ensure icmp redirects are not accepted,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.accept_redirects=0', 'net.ipv4.conf.default.accept_redirects=0', 'net.ipv6.conf.all.accept_redirects=0', 'net.ipv6.conf.default.accept_redirects=0']",Contain,PASS
3.3.6,L1,"Server, Workstation",Network Configuration,Ensure secure icmp redirects are not accepted,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.secure_redirects=0', 'net.ipv4.conf.default.secure_redirects=0']",Contain,PASS
3.3.7,L1,"Server, Workstation",Network Configuration,Ensure reverse path filtering is enabled,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.rp_filter=1', 'net.ipv4.conf.default.rp_filter=1']",Contain,PASS
3.3.8,L1,"Server, Workstation",Network Configuration,Ensure source routed packets are not accepted,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.accept_source_route=0', 'net.ipv4.conf.default.accept_source_route=0', 'net.ipv6.conf.all.accept_source_route=0', 'net.ipv6.conf.default.accept_source_route=0']",Contain,PASS
3.3.9,L1,"Server, Workstation",Network Configuration,Ensure suspicious packets are logged,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.log_martians=1', 'net.ipv4.conf.default.log_martians=1']",Contain,PASS
4.1.1,L1,"Server, Workstation",Host Based Firewall,Ensure a single firewall configuration utility is in use,execute_script,ensure_a_single_firewall_configuration_utility_is_in_use.sh,'',Contain,PASS
4.2.1,L1,"Server, Workstation",Host Based Firewall,Ensure ufw is installed,command_output,"dpkg-query -s ufw &>/dev/null && echo ""ufw is installed""",'',Exact,ufw is installe
4.2.2,L1,"Server, Workstation",Host Based Firewall,Ensure nftables is not in use with ufw,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify nftables.service is not enabled', 'type_handler': 'command_output', 'target': 'dpkg-query -s nftables &>/dev/null && echo ""nftables is installed""', 'algorithm': 'Null'}, {'logic': 'AND', 'steps': [{'title': 'verify nftables.service is not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled nftables.service 2>/dev/null | grep \'^enabled\'', 'algorithm': 'Null'}, {'title': 'verify nftables.service is not active', 'type_handler': 'command_output', 'target': 'systemctl is-active nftables.service 2>/dev/null | grep \'^active\'', 'algorithm': 'Null'}]}]}",,
4.2.3,L1,"Server, Workstation",Host Based Firewall,Ensure iptables-persistent is not installed with ufw,command_output,"dpkg-query -s iptables-persistent &>/dev/null && echo ""iptables-persistent is installed""",'',Null,
4.2.4,L1,"Server, Workstation",Host Based Firewall,Ensure ufw service is enabled,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify that the ufw daemon is enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled ufw.service', 'algorithm': 'Exact', 'expected_value': 'enabled'}, {'title': 'verify that the ufw daemon is active', 'type_handler': 'command_output', 'target': 'systemctl is-active ufw', 'algorithm': 'Exact', 'expected_value': 'active'}, {'title': 'verify ufw is active', 'type_handler': 'command_output', 'target': 'ufw status', 'algorithm': 'Contain', 'expected_value': 'Status: active'}]}",,
4.2.5,L1,"Server, Workstation",Host Based Firewall,Ensure ufw loopback traffic is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify loopback interface to accept traffiic', 'type_handler': 'command_output', 'target': 'grep -P -- \'lo|127.0.0.0\' /etc/ufw/before.rules', 'algorithm': 'Contain', 'expected_value': '# allow all on loopback -A ufw-before-input -i lo -j ACCEPT -A ufw-before-output -o lo -j ACCEPT'}, {'title': 'verify all other interfaces deny traffic to the loopback network (127.0.0.0/8 for IPv4 and ::1/128 for IPv6)', 'type_handler': 'command_output', 'target': 'ufw status verbose', 'algorithm': 'Contain', 'expected_value': 'To                         Action      From --                         ------      ----                   Anywhere                   DENY IN     127.0.0.0/8                           Anywhere (v6)              DENY IN     ::1      '}]}",,
4.2.7,L1,"Server, Workstation",Host Based Firewall,Ensure ufw firewall rules exist for all open ports,execute_script,ensure_ufw_firewall_rules_exist_for_all_open_ports.sh,'',Contain,PASS
4.2.8,L1,"Server, Workstation",Host Based Firewall,Ensure ufw default deny firewall policy,command_output,ufw status verbose | grep Default:,,Contain,"Default: deny (incoming), deny (outgoing), disabled (routed)"
5.1.1,L1,"Server, Workstation",Access Control,Ensure access to /etc/ssh/sshd_config is configured,execute_script,ensure_acces_to_etcsshsshd_config_is_configured.sh,'',Contain,PASS
5.1.10,L1,"Server, Workstation",Access Control,Ensure sshd HostbasedAuthentication is disabled,command_output,"sshd -T | grep hostbasedauthentication  awk '{print ($2==""no"")? ""PASS"":""FAIL""}'",,Exact,PASS
5.1.11,L1,"Server, Workstation",Access Control,Ensure sshd IgnoreRhosts is enabled,command_output,"sshd -T | grep ignorerhosts | awk '{print ($2==""yes"")? ""PASS"":""FAIL""}'",,Exact,PASS
5.1.12,L1,"Server, Workstation",Access Control,Ensure sshd KexAlgorithms is configured,command_output,"sshd -T | grep -Pi -- 'kexalgorithms\h+([^#\n\r]+,)?(diffie-hellman-group1-sha1|diffie-hellman-group14-sha1|diffie-hellman-group-exchange-sha1)\b'",,Null,
5.1.13,L1,"Server, Workstation",Access Control,Ensure sshd LoginGraceTime is configured,command_output," sshd -T | grep logingracetime | awk '{e=$2} END {print (1<=e && e<=60) ? ""PASS"":""FAIL""}'",,Exact,PASS
5.1.14,L1,"Server, Workstation",Access Control,Ensure sshd LogLevel is configured,command_output,sshd -T | grep loglevel,,Exact,loglevel VERBOSE;loglevel INFO
5.1.15,L1,"Server, Workstation",Access Control,Ensure sshd MACs are configured,command_output,"sshd -T | grep -Pi -- 'macs\h+([^#\n\r]+,)?(hmac-md5|hmac-md5-96|hmac-ripemd160|hmac-sha1-96|umac-64@openssh\.com|hmac-md5-etm@openssh\.com|hmac-md5-96-etm@openssh\.com|hmac-ripemd160-etm@openssh\.com|hmac-sha1-96-etm@openssh\.com|umac-64-etm@openssh\.com|umac-128-etm@openssh\.com)\b'",,Null,
5.1.16,L1,"Server, Workstation",Access Control,Ensure sshd MaxAuthTries is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'Verify MaxAuthTries global is ≤ 4', 'type_handler': 'command_output', 'target': 'sudo sshd -T | grep maxauthtries | awk \'{print($2 <=4) ? ""PASS"":""FAIL""}\'', 'algorithm': 'Exact', 'expected_value': 'PASS'}, {'title': 'Verify MaxAuthTries for Match blocks is ≤ 4', 'type_handler': 'command_output', 'target': 'sshd -T -C user=sshuser | grep maxauthtries | awk \'{print($2 <=4) ? ""PASS"":""FAIL""}\'', 'algorithm': 'Exact', 'expected_value': 'PASS'}]}",,
5.1.17,L1,"Server, Workstation",Access Control,Ensure sshd MaxSessions is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'Verify Maxsessions global is ≤ 10', 'type_handler': 'command_output', 'target': 'sudo sshd -T | grep maxsessions | awk \'{print ($2<=10) ? ""PASS"":""FAIL"" }\'', 'algorithm': 'Exact', 'expected_value': 'PASS'}, {'title': 'Check the config file directly for unsafe values', 'type_handler': 'command_output', 'target': 'grep -Psi -- \'^\\h*MaxSessions\\h+\\""?(1[1-9]|[2-9][0-9]|[1-9][0-9][0-9]+)\\b\' /etc/ssh/sshd_config /etc/ssh/sshd_config.d/*.conf', 'algorithm': 'Null'}, {'title': 'Verify Maxsessions for Match blocks is ≤ 10', 'type_handler': 'command_output', 'target': 'sshd -T -C user=sshuser | grep maxsessions | awk \'{print ($2<=10) ? ""PASS"":""FAIL"" }\'', 'algorithm': 'Exact', 'expected_value': 'PASS'}]}",,
5.1.18,L1,"Server, Workstation",Access Control,Ensure sshd MaxStartups is configured,command_output,"sshd -T | awk '$1 ~ /^\s*maxstartups/{split($2, a, "":"");{if(a[1] > 10 || a[2] > 30 || a[3] > 60) print $0}}'",,Null,
5.1.19,L1,"Server, Workstation",Access Control,Ensure sshd PermitEmptyPasswords is disabled,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify PermitEmptyPasswords is set to no', 'type_handler': 'command_output', 'target': 'sshd -T | grep permitemptypasswords', 'algorithm': 'Exact', 'expected_value': 'permitemptypasswords no'}, {'title': 'Verify PermitEmptyPasswords for Match blocks is set to no', 'type_handler': 'command_output', 'target': 'sshd -T -C user=sshuser | grep permitemptypasswords', 'algorithm': 'Exact', 'expected_value': 'permitemptypasswords no'}]}",,
5.1.2,L1,"Server, Workstation",Access Control,Ensure access to SSH private host key files is configured,execute_script,ensure_access_to_SSH_private_host_key_files_is_configured.sh,'',Contain,PASS
5.1.20,L1,"Server, Workstation",Access Control,Ensure sshd PermitRootLogin is disabled,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify PermitRootLogin is set to no', 'type_handler': 'command_output', 'target': 'sshd -T | grep permitrootlogin', 'algorithm': 'Exact', 'expected_value': 'permitrootlogin no'}, {'title': 'Verify Permitrootlogin for Match blocks is set to no', 'type_handler': 'command_output', 'target': 'sshd -T -C user=sshuser | grep permitrootlogin', 'algorithm': 'Exact', 'expected_value': 'permitrootlogin no'}]}",,
5.1.21,L1,"Server, Workstation",Access Control,Ensure sshd PermitUserEnvironment is disabled,command_output,sshd -T | grep permituserenvironment,,Exact,permituserenvironment no
5.1.22,L1,"Server, Workstation",Access Control,Ensure sshd UsePAM is enabled,command_output,sshd -T | grep usepam,,Exact,usepam yes
5.1.3,L1,"Server, Workstation",Access Control,Ensure access to SSH public host key files is configured,execute_script,ensure_access_to_SSH_public_host_key_files_is_configured.sh,,Contain,PASS
5.1.6,L1,"Server, Workstation",Access Control,Ensure sshd Ciphers are configured,command_output,"sshd -T | grep -Pi -- '^ciphers\h+\""?([^#\n\r]+,)?((3des|blowfish|cast128|aes(128|192|256))-cbc|arcfour(128|256)?|rijndael-cbc@lysator\.liu\.se|chacha20-poly1305@openssh\.com)\b'",,Null,
5.1.7,L1,Workstation,Access Control,Ensure sshd ClientAliveInterval and ClientAliveCountMax are configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify ClientAliveInterval is greater than zero', 'type_handler': 'command_output', 'target': 'sshd -T | grep -Pi -- \'(clientaliveinterval)\' | awk \'{print ($2 > 0) ? ""PASS"" : ""FAIL""}\'', 'algorithm': 'Exact', 'expected_value': 'PASS'}, {'title': 'verify ClientAliveCountMax is greater than zero', 'type_handler': 'command_output', 'target': 'sshd -T | grep -Pi -- \'(clientalivecountmax)\' | awk \'{print ($2 > 0) ? ""PASS"" : ""FAIL""}\'', 'algorithm': 'Exact', 'expected_value': 'PASS'}]}",,
5.1.8,L1,Workstation,Access Control,Ensure sshd DisableForwarding is enabled,command_output,sshd -T | grep disableforwarding,,Exact,disableforwarding yes
5.1.9,L1,Workstation,Access Control,Ensure sshd GSSAPIAuthentication is disabled,command_output,"sshd -T | grep gssapiauthentication | awk '{print ($2==""no"")? ""PASS"":""FAIL""}'",,Exact,PASS
5.2.1,L1,"Server, Workstation",Access Control,Ensure sudo is installed,multi_procedure,N/A,"{'logic': 'OR', 'steps': [{'title': 'verify that either sudo is installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s sudo &>/dev/null && echo ""sudo is installed""', 'algorithm': 'Exact', 'expected_value': 'sudo is installed'}, {'title': 'verify that either sudo-ldap is installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s sudo-ldap &>/dev/null && echo ""sudo-ldap is installed""', 'algorithm': 'Exact', 'expected_value': 'sudo-ldap is installed'}]}",,
5.2.2,L1,"Server, Workstation",Access Control,Ensure sudo commands use pty,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify Defaults use_pty is set', 'type_handler': 'command_output', 'target': 'grep -rPi -- ""^\\h*Defaults\\h+([^#\\n\\r]+,\\h*)?use_pty\\b"" /etc/sudoers*', 'algorithm': 'Exact', 'expected_value': '/etc/sudoers:Defaults use_pty'}, {'title': 'verify Defaults !use_pty is not set:', 'type_handler': 'command_output', 'target': 'grep -rPi -- ""^\\h*Defaults\\h+([^#\\n\\r]+,\\h*)?!use_pty\\b"" /etc/sudoers*', 'algorithm': 'Null'}]}",,
5.2.3,L1,"Server, Workstation",Access Control,Ensure sudo log file exists,command_output,"grep -rPsi ""^\h*Defaults\h+([^#]+,\h*)?logfile\h*=\h*(\""|\')?\H+(\""|\')?(,\h*\H+\h*)*\h*(#.*)?$"" /etc/sudoers*",'',Exact,"Defaults logfile=""/var/log/sudo.log"""
5.2.5,L1,"Server, Workstation",Access Control,Ensure re-authentication for privilege escalation is not disabled globally,command_output,"grep -r ""^[^#].*\!authenticate"" /etc/sudoers*",'',Does Not Contain,!authenticate
5.2.6,L1,"Server, Workstation",Access Control,Ensure sudo authentication timeout is configured,command_output,"sudo -V | awk '/Authentication timestamp timeout:/ {val = $4} END {print (val >= 15) ? ""PASS"" : ""FAIL""}'",'',Exact,PASS
5.3.1.1,L1,"Server, Workstation",Access Control,Ensure latest version of pam is installed,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify libpam-runtime is installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s libpam-runtime &>/dev/null && echo ""libpam-runtime is installed""', 'algorithm': 'Exact', 'expected_value': 'libpam-runtime is installed'}, {'title': 'verify libpam-runtime is the latest version', 'type_handler': 'command_output', 'target': 'apt list --upgradable 2>&1 | grep -P \'^libpam-runtime\\b\'', 'algorithm': 'Null'}]}",,
5.3.1.2,L1,"Server, Workstation",Access Control,Ensure latest version of libpam-modules is installed,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify libpam-modules is installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s libpam-modules &>/dev/null && echo ""libpam-modules is installed""', 'algorithm': 'Exact', 'expected_value': 'libpam-modules is installed'}, {'title': 'verify libpam-modules is the latest version', 'type_handler': 'command_output', 'target': 'apt list --upgradable 2>&1 | grep -P \'^libpam-modules\\b\'', 'algorithm': 'Null'}]}",,
5.3.1.3,L1,"Server, Workstation",Access Control,Ensure latest version of libpam-pwquality is installed,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify libpam-pwquality is installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s libpam-pwquality &>/dev/null && echo ""libpam-pwquality is installed""', 'algorithm': 'Exact', 'expected_value': 'libpam-pwquality is installed'}, {'title': 'verify libpam-pwquality is the latest version', 'type_handler': 'command_output', 'target': 'apt list --upgradable 2>&1 | grep -P \'^libpam-pwquality\\b\'', 'algorithm': 'Null'}]}",,
5.3.2.1,L1,"Server, Workstation",Access Control,Ensure pam_unix module is enabled,command_output,"grep -PH -- '\bpam_unix\.so\b' /etc/pam.d/common-{account,auth,password,session,session-noninteractive}",,Contain,/etc/pam.d/common-account:account   [success=1 new_authtok_reqd=done default=ignore]   pam_unix.so /etc/pam.d/common-auth:auth   [success=2 default=ignore]   pam_unix.so try_first_pass /etc/pam.d/common-password:password   [success=1 default=ignore]   pam_unix.so obscure use_authtok try_first_pass yescrypt /etc/pam.d/common-session:session   required   pam_unix.so /etc/pam.d/common-session-noninteractive:session   required   pam_unix.so
5.3.2.2,L1,"Server, Workstation",Access Control,Ensure pam_faillock module is enabled,command_output,"grep -P -- '\bpam_faillock\.so\b' /etc/pam.d/common-{auth,account}",,Contain,/etc/pam.d/common-auth:auth     requisite                       pam_faillock.so preauth /etc/pam.d/common-auth:auth     [default=die]                   pam_faillock.so authfail /etc/pam.d/common-account:account       required                        pam_faillock.so
5.3.2.3,L1,"Server, Workstation",Access Control,Ensure pam_pwquality module is enabled,command_output,grep -P -- '\bpam_pwquality\.so\b' /etc/pam.d/common-password,,Contain,password   requisite   pam_pwquality.so retry=3
5.3.2.4,L1,"Server, Workstation",Access Control,Ensure pam_pwhistory module is enabled,command_output,grep -P -- '\bpam_pwhistory\.so\b' /etc/pam.d/common-password,,Contain,password   requisite   pam_pwhistory.so remember=24 enforce_for_root use_authtok
5.3.3.1.1,L1,"Server, Workstation",Access Control,Ensure password failed attempts lockout is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify that Number of failed logon attempts before the account is locked is no greater than 5 and meets local site policy', 'type_handler': 'command_output', 'target': 'grep -Pi -- \'^\\h*deny\\h*=\\h*[1-5]\\b\' /etc/security/faillock.conf', 'algorithm': 'Not Null'}, {'title': 'verify that the deny argument has not been set, or 5 or less and meets local site policy', 'type_handler': 'command_output', 'target': 'grep -Pi -- \'^\\h*auth\\h+(requisite|required|sufficient)\\h+pam_faillock\\.so\\h+([^#\\n\\r]+\\h+)?deny\\h*=\\h*(0|[6-9]|[1-9][0-9]+)\\b\' /etc/pam.d/common-auth', 'algorithm': 'Null'}]}",,
5.3.3.1.2,L1,"Server, Workstation",Access Control,Ensure password unlock time is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': ' verify that the time in seconds before the account is unlocked is either 0 (never) or 900 (15 minutes) or more and meets local site policy', 'type_handler': 'command_output', 'target': 'grep -Pi -- \'^\\h*unlock_time\\h*=\\h*(0|9[0-9][0-9]|[1-9][0-9]{3,})\\b\' /etc/security/faillock.conf', 'algorithm': 'Not Null'}, {'title': 'verify that the unlock_time argument has not been set, or is either 0 (never) or 900 (15 minutes) or more and meets local site policy', 'type_handler': 'command_output', 'target': 'grep -Pi -- \'^\\h*auth\\h+(requisite|required|sufficient)\\h+pam_faillock\\.so\\h+([^#\\n\\r]+\\h+)?unlock_time\\h*=\\h*([1-9]|[1-9][0-9]|[1-8][0-9][0-9])\\b\' /etc/pam.d/common-auth', 'algorithm': 'Null'}]}",,
5.3.3.2.1,L1,"Server, Workstation",Access Control,Ensure password number of changed characters is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify that the difok option is set to 2 or more and follows local site policy', 'type_handler': 'command_output', 'target': 'grep -Psi -- \'^\\h*difok\\h*=\\h*([2-9]|[1-9][0-9]+)\\b\' /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf', 'algorithm': 'Not Null'}, {'title': 'verify that difok is not set, is 2 or more, and conforms to local site policy', 'type_handler': 'command_output', 'target': 'grep -Psi -- \'^\\h*password\\h+(requisite|required|sufficient)\\h+pam_pwquality\\.so\\h+([^#\\n\\r]+\\h+)?difok\\h*=\\h*([0-1])\\b\' /etc/pam.d/common-password', 'algorithm': 'Not Null'}]}",,
5.3.3.2.2,L1,"Server, Workstation",Access Control,Ensure minimum password length is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify that password length is 14 or more characters, and conforms to local site policy', 'type_handler': 'command_output', 'target': 'grep -Psi -- \'^\\h*minlen\\h*=\\h*(1[4-9]|[2-9][0-9]|[1-9][0-9]{2,})\\b\' /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf', 'algorithm': 'Not Null'}, {'title': 'verify that minlen is not set, or is 14 or more characters, and conforms to local site policy', 'type_handler': 'command_output', 'target': 'grep -Psi -- \'^\\h*password\\h+(requisite|required|sufficient)\\h+pam_pwquality\\.so\\h+([^#\\n\\r]+\\h+)?minlen\\h*=\\h*([0-9]|1[0-3])\\b\' /etc/pam.d/system-auth /etc/pam.d/common-password', 'algorithm': 'Null'}]}",,
5.4.1.1,L1,"Server, Workstation",Access Control,Ensure password expiration is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'Recovered from corrupted data - please edit', 'type_handler': 'command_output', 'target': 'grep -Pi -- \'^\\h*PASS_MAX_DAYS\\h+\\d+\\b\' /etc/login.defs | awk \'{print ($2 <= 365) ? ""PASS"" : ""FAIL""}\'', 'algorithm': 'Contain', 'expected_value': 'PASS'}, {'title': 'verify all /etc/shadow passwords PASS_MAX_DAYS', 'type_handler': 'command_output', 'target': 'awk -F: \'($2~/^\\$.+\\$/) {if($5 > 365 || $5 < 1)print ""User: "" $1 "" PASS_MAX_DAYS: "" $5}\' /etc/shadow', 'algorithm': 'Null'}]}",,
5.4.1.2,L2,"Server, Workstation",Access Control,Ensure minimum password days is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'erify that PASS_MIN_DAYS is set to a value greater than 0and follows local site policy', 'type_handler': 'command_output', 'target': 'grep -Pi -- \'^\\h*PASS_MIN_DAYS\\h+\\d+\\b\' /etc/login.defs | awk \'{print ($2 <= 45) ? ""PASS"" : ""FAIL""}\'', 'algorithm': 'Contain', 'expected_value': 'PASS'}, {'title': 'verify all passwords have a PASS_MIN_DAYS greater than 0', 'type_handler': 'command_output', 'target': 'awk -F: \'($2~/^\\$.+\\$/) {if($4 < 1)print ""User: "" $1 "" PASS_MIN_DAYS: "" $4}\' /etc/shadow', 'algorithm': 'Null'}]}",,
5.4.1.3,L1,"Server, Workstation",Access Control,Ensure password expiration warning days is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify PASS_WARN_AGE is 7 or more and follows local site policy', 'type_handler': 'command_output', 'target': 'grep -Pi -- \'^\\h*PASS_WARN_AGE\\h+\\d+\\b\' /etc/login.defs | awk \'{print ($2 >= 7) ? ""PASS"" : ""FAIL""}\'', 'algorithm': 'Exact', 'expected_value': 'PASS'}, {'title': 'verify all passwords have a PASS_WARN_AGE of 7 or more', 'type_handler': 'command_output', 'target': 'awk -F: \'($2~/^\\$.+\\$/) {if($6 < 7)print ""User: "" $1 "" PASS_WARN_AGE: "" $6}\' /etc/shadow', 'algorithm': 'Null'}]}",,
5.4.1.4,L1,"Server, Workstation",Access Control,Ensure strong password hashing algorithm is configured,command_output,grep -Pi -- '^\h*ENCRYPT_METHOD\h+(SHA512|yescrypt)\b' /etc/login.defs,'',Exact,ENCRYPT_METHOD SHA512;ENCRYPT_METHOD  YESCRYPT
5.4.1.5,L1,"Server, Workstation",Access Control,Ensure inactive password lock is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'erify INACTIVE conforms to site policy (no more than 45 days)', 'type_handler': 'command_output', 'target': 'useradd -D | awk \'/INACTIVE=/{day=$1} END {print (day <=45) ? ""PASS"" : ""FAIL""}\'', 'algorithm': 'Exact', 'expected_value': 'PASS'}, {'title': 'verify that all users INACTIVE conforms to site policy (no more than 45 days)', 'type_handler': 'command_output', 'target': 'awk -F: \'($2~/^\\$.+\\$/) {if($7 > 45 || $7 < 0)print ""User: "" $1 "" INACTIVE: "" $7 ""Days""}\' /etc/shadow', 'algorithm': 'Null'}]}",,
5.4.1.6,L1,"Server, Workstation",Access Control,Ensure all users last password change date is in the past,execute_script,ensure_all_users_last_password_change_date_is_in_the_past.sh,'',Null,
5.4.2.1,L1,"Server, Workstation",Access Control,Ensure root is the only UID 0 account,command_output,awk -F: '($3 == 0) { print $1 }' /etc/passwd,'',Exact,root
5.4.2.2,L1,"Server, Workstation",Access Control,Ensure root is the only GID 0 account,command_output,"awk -F: '($1 !~ /^(sync|shutdown|halt|operator)/ && $4==""0"") {print $1"":""$4}' /etc/passwd",'',Exact,root:0
5.4.2.3,L1,"Server, Workstation",Access Control,Ensure group root is the only GID 0 group,command_output,"awk -F: '$3==""0""{print $1"":""$3}' /etc/group",'',Exact,root:0
5.4.2.4,L1,"Server, Workstation",Access Control,Ensure root account access is controlled,command_output,"passwd -S root | awk '$2 ~ /^(P|L)/ {print ""User: \"""" $1 ""\"" Password is status: "" $2}'",'',Exact,"User: ""root"" Password is status: P;User: ""root"" Password is status: L"
5.4.2.5,L1,"Server, Workstation",Access Control,Ensure root path integrity,execute_script,ensure_root_path_integrity.sh,'',Contain,PASS
5.4.2.6,L1,"Server, Workstation",Access Control,Ensure root user umask is configured,command_output,"grep -Psi -- '^\h*umask\h+(([0-7][0-7][01][0-7]\b|[0-7][0-7][0-7][0-6]\b)|([0-7][01][0-7]\b|[0-7][0-7][0-6]\b)|(u=[rwx]{1,3},)?(((g=[rx]?[rx]?w[rx]?[rx]?\b)(,o=[rwx]{1,3})?)|((g=[wrx]{1,3},)?o=[wrx]{1,3}\b)))' /root/.bash_profile /root/.bashrc /etc/login.defs",'',Null,
5.4.2.7,L1,"Server, Workstation",Access Control,Ensure system accounts do not have a valid login shell,execute_script,ensure_system_accounts_do_not_have_a_valid_login_shell.sh,'',Null,
5.4.2.8,L1,"Server, Workstation",Access Control,Ensure accounts without a valid login shell are locked,execute_script,ensure_accounts_without_a_valid_login_shell_are_locked.sh,'',Null,
5.4.3.2,L1,"Server, Workstation",Access Control,Ensure default user shell timeout is configured,execute_script,ensure_default_user_shell_timeout_is_configured.sh,'',Contain,PASS
5.4.3.3,L1,"Server, Workstation",Access Control,Ensure default user umask is configured,execute_script,ensure_default_user_unmask_is_configured.sh,'',Contain,PASS
6.1.1,L1,"Server, Workstation",Logging and Auditing,Ensure AIDE is installed,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify aide is installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s aide &>/dev/null && echo ""aide is installed""', 'algorithm': 'Exact', 'expected_value': 'aide is installed'}, {'title': 'verify aide-common is installed', 'type_handler': 'command_output', 'target': 'dpkg-query -s aide-common &>/dev/null && echo ""aide-common is installed""', 'algorithm': 'Exact', 'expected_value': 'aide-common is installed'}]}",,
6.1.2,L1,"Server, Workstation",Logging and Auditing,Ensure filesystem integrity is regularly checked,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'Verify dailyaidecheck.timer is enabled', 'type_handler': 'command_output', 'target': ' systemctl list-unit-files | awk \'$1~/^dailyaidecheck\\.(timer)$/{print ($2)}\'', 'algorithm': 'Exact', 'expected_value': 'enabled'}, {'title': 'Verify dailyaidecheck.service is either static or enabled', 'type_handler': 'command_output', 'target': 'systemctl list-unit-files | awk \'$1~/^dailyaidecheck\\.(service)$/{print $2}\'', 'algorithm': 'Exact', 'expected_value': 'static;enabled'}, {'title': 'verify dailyaidecheck.timer is active', 'type_handler': 'command_output', 'target': 'systemctl is-active dailyaidecheck.timer', 'algorithm': 'Exact', 'expected_value': 'active'}]}",,
6.1.3,L1,"Server, Workstation",Logging and Auditing,Ensure cryptographic mechanisms are used to protect the integrity of audit tools,command_output,grep -Ps -- '(\/sbin\/(audit|au)\H*\b)' /etc/aide.conf /etc/aide/aide.conf /etc/aide.conf.d/*.conf /etc/aide/aide.conf.d/*,,Contain,/sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512  /sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512  /sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512  /sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512  /sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512  /sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512
6.2.1.1,L1,"Server, Workstation",Logging and Auditing,Ensure journald service is enabled and active,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify systemd-journald is enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled systemd-journald.service', 'algorithm': 'Exact', 'expected_value': 'static'}, {'title': 'verify systemd-journald is active', 'type_handler': 'command_output', 'target': 'systemctl is-active systemd-journald.service', 'algorithm': 'Exact', 'expected_value': 'active'}]}",,
6.2.1.2,L1,"Server, Workstation",Logging and Auditing,Ensure journald log file access is configured,execute_script,ensure_journald_log_file_access_is_configured.sh,'',Contain,PASS
6.2.1.3,L1,"Server, Workstation",Logging and Auditing,Ensure journald log file rotation is configured,execute_script,ensure_journald_log_file_rotation_is_configured.sh,'',Contain,PASS
6.2.2.1.1,L1,"Server, Workstation",Logging and Auditing,Ensure systemd-journal-remote is installed,command_output,"dpkg-query -s systemd-journal-remote &>/dev/null && echo ""systemd-journal-remote is installed""",'',Exact,systemd-journal-remote is installed
6.2.2.1.3,L1,"Server, Workstation",Logging and Auditing,Ensure systemd-journal-upload is enabled and active,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify systemd-journal-upload is enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled systemd-journal-upload.service', 'algorithm': 'Exact', 'expected_value': 'enabled'}, {'title': 'verify systemd-journal-upload is active', 'type_handler': 'command_output', 'target': 'systemctl is-active systemd-journal-upload.service', 'algorithm': 'Exact', 'expected_value': 'active'}]}",,
6.2.2.1.4,L1,"Server, Workstation",Logging and Auditing,Ensure systemd-journal-remote service is not in use,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify systemd-journal-remote.socket and systemd-journal-remote.service are not enabled', 'type_handler': 'command_output', 'target': 'systemctl is-enabled systemd-journal-remote.socket systemd-journal-remote.service | grep -P -- \'^enabled\'', 'algorithm': 'Null'}, {'title': 'verify systemd-journal-remote.socket and systemd-journal-remote.service are not active', 'type_handler': 'command_output', 'target': 'systemctl is-active systemd-journal-remote.socket systemd-journal-remote.service | grep -P -- \'^active\'', 'algorithm': 'Null'}]}",,
6.2.2.2,L1,"Server, Workstation",Logging and Auditing,Ensure journald ForwardToSyslog is disabled,command_output,"grep -Psi ""^ForwardToSyslog=no"" /etc/systemd/journald.conf /etc/systemd/journald.conf.d/*",,Exact,ForwardToSyslog=no
6.2.2.3,L1,"Server, Workstation",Logging and Auditing,Ensure journald Compress is configured,command_output,"grep -Psi ""^Compress=yes"" /etc/systemd/journald.conf /etc/systemd/journald.conf.d/*",,Exact,Compress=yes
6.2.2.4,L1,"Server, Workstation",Logging and Auditing,Ensure journald Storage is configured,command_output,"grep -Psi ""^Storage=persistent"" /etc/systemd/journald.conf /etc/systemd/journald.conf.d/*",,Exact,Storage=persistent
7.1.1,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/passwd is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/passwd,'',Exact,Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.10,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/security/opasswd is configured,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify /etc/security/opasswd are mode 600 or more restrictive, Uid is 0/root and Gid is 0/root if they exist', 'type_handler': 'command_output', 'target': '[ -e ""/etc/security/opasswd"" ] && stat -Lc \'%n Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)\' /etc/security/opasswd', 'algorithm': 'Exact', 'expected_value': '/etc/security/opasswd Access: (0600/-rw-------)  Uid: ( 0/ root) Gid: ( 0/ root); '}, {'title': 'verify /etc/security/opasswd.old are mode 600 or more restrictive, Uid is 0/root and Gid is 0/root if they exist', 'type_handler': 'command_output', 'target': '[ -e ""/etc/security/opasswd.old"" ] && stat -Lc \'%n Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)\' /etc/security/opasswd.old', 'algorithm': 'Exact', 'expected_value': '/etc/security/opasswd.old Access: (0600/-rw-------)  Uid: ( 0/ root) Gid: ( 0/ root); '}]}",,
7.1.11,L1,"Server, Workstation",System Maintenance,Ensure world writable files and directories are secured,execute_script,ensure_world_writable_files_and_directories_are_secured.sh,,Contain,PASS
7.1.12,L1,"Server, Workstation",System Maintenance,Ensure no files or directories without an owner and a group exist,execute_script,ensure_no_files_or_directories_without_an_owner_and_a_group_exist.sh,,Contain,PASS
7.1.2,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/passwd- is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: { %g/ %G)' /etc/passwd-,,Exact,Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: { 0/ root)
7.1.3,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/group is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/group,,Exact,Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.4,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/group- is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/group-,,Exact,Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.5,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/shadow is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/shadow,,Contain,Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 42/ shadow);Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.6,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/shadow- is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/shadow-,,Exact,Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 42/ shadow);Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.7,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/gshadow is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/gshadow,,Exact,Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 42/ shadow);Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.8,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/gshadow- is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/gshadow-,,Exact,Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 42/ shadow);Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.9,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/shells is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/shells,,Exact,Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)
7.2.1,L1,"Server, Workstation",System Maintenance,Ensure accounts in /etc/passwd use shadowed passwords,command_output,"awk -F: '($2 != ""x"" ) { print ""User: \"""" $1 ""\"" is not set to shadowed passwords ""}' /etc/passwd",,Null,
7.2.10,L1,"Server, Workstation",System Maintenance,Ensure local interactive user dot files access is configured,execute_script,ensure_local_interactive_user_dot_files_access_is_configured.sh,,Contain,PASS
7.2.2,L1,"Server, Workstation",System Maintenance,Ensure /etc/shadow password fields are not empty,command_output,"awk -F: '($2 == """" ) { print $1 "" does not have a password ""}' /etc/shadow",,Null,
7.2.3,L1,"Server, Workstation",System Maintenance,Ensure all groups in /etc/passwd exist in /etc/group,execute_script,ensure_all_groups_in_etcpasswd_exist_in_etcgroup.sh,,Null,
7.2.4,L1,"Server, Workstation",System Maintenance,Ensure shadow group is empty,multi_procedure,N/A,"{'logic': 'AND', 'steps': [{'title': 'verify no results are returned from Shadow', 'type_handler': 'command_output', 'target': 'awk -F: \'($1==""shadow"") {print $NF}\' /etc/group', 'algorithm': 'Null'}, {'title': 'verify no results are returned from Shadow', 'type_handler': 'command_output', 'target': 'awk -F: \'($4 == \'""$(getent group shadow | awk -F: \'{print $3}\' | xargs)""\') {print ""  - user: \\"""" $1 ""\\"" primary group is the shadow group""}\' /etc/passwd', 'algorithm': 'Null'}]}",,
7.2.5,L1,"Server, Workstation",System Maintenance,Ensure no duplicate UIDs exist,execute_script,ensure_no_duplicate_UIDs_exist.sh,,Null,
7.2.6,L1,"Server, Workstation",System Maintenance,Ensure no duplicate GIDs exist,execute_script,ensure_no_duplicate_GIDs_exist.sh,,Null,
7.2.7,L1,"Server, Workstation",System Maintenance,Ensure no duplicate user names exist,execute_script,ensure_no_duplicate_user_names_exist.sh,,Null,
7.2.8,L1,"Server, Workstation",System Maintenance,Ensure no duplicate group names exist,execute_script,ensure_no_duplicate_group_names_exist.sh,,Null,
7.2.9,L1,"Server, Workstation",System Maintenance,Ensure local interactive user home directories are configured,execute_script,ensure_local_interactive_user_home_directories_are_configured.sh,,Contain,PASS