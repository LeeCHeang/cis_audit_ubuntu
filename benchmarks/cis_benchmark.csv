ID,Level,Profile,Domain,Title,Check_Type,Target,Parameters,Algorithm,Expected_Value
1.1.1.1,L1,"Server, Workstation",Initial Setup,Esure cramfs kernel module is not available,multi_procedure,N/A,"{'steps':[{'name':'Determine if hfs is available on the system','type':'script','algorithm':'Null','expected_value':'','target_script':'ensure_kernel_module_is_not_available.sh','script_params':['cramfs']},{'name':'Check kernel module is not loaded','type':'command','algorithm':'Null','expected_value':'','command':'lsmod | grep \'cramfs\''},{'name':'Check kernel module is not loadable','type':'command','algorithm':'Contain','expected_value':'blacklist cramfs;install cramfs /bin/false;install cramfs /bin/true','command':'modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+cramfs\\b\''}]}",,
1.1.1.2,L1,"Server, Workstation",Initial Setup,Ensure freevxfs kernel module is not available,multi_procedure,N/A,"{'steps':[{'name':'Determent the File in Kernel','type':'script','algorithm':'Null','expected_value':'','pass_stop_check':'True','target_script':'ensure_kernel_module_is_not_available.sh','script_params':['freevxfs']},{'name':'Check kernel module is not loaded','type':'command','algorithm':'Null','expected_value':'','command':'lsmod | grep \'freevxfs\''},{'name':'Check kernel module is not loadable','type':'command','algorithm':'Contain','expected_value':'blacklist freevxfs;install freevxfs /bin/false;install freevxfs /bin/true','command':'modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+freevxfs\\b\''}]}",,
1.1.1.3,L1,"Server, Workstation",Initial Setup,Ensure hfs kernel module is not available,multi_procedure,N/A,"{'steps':[{'name':'Determine if hfs is available on the system','type':'script','algorithm':'Null','expected_value':'','pass_stop_check':'True','target_script':'ensure_kernel_module_is_not_available.sh','script_params':['hfs']},{'name':'Check kernel module is not loaded','type':'command','algorithm':'Null','expected_value':'','command':'lsmod | grep \'hfs\''},{'name':'Check kernel module is not loadable','type':'command','algorithm':'Contain','expected_value':'blacklist hfs;install hfs /bin/false;install hfs /bin/true','command':'modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+hfs\\b\''}]}",,
1.1.1.4,L1,"Server, Workstation",Initial Setup,Ensure hfsplus kernel module is not available,multi_procedure,N/A,"{'steps':[{'name':'Determine hfsplus if it available on the system','type':'script','algorithm':'Null','expected_value':'','pass_stop_check':'True','target_script':'ensure_kernel_module_is_not_available.sh','script_params':['hfsplus']},{'name':'Check kernel module is not loaded','type':'command','algorithm':'Null','expected_value':'','command':'lsmod | grep \'hfsplus\''},{'name':'Check kernel module is not loadable','type':'command','algorithm':'Contain','expected_value':'blacklist hfs;install hfs /bin/false;install hfs /bin/true','command':'modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+hfsplus\\b\''}]}",,
1.1.1.5,L1,"Server, Workstation",Initial Setup,Ensure jffs2 kernel module is not available,multi_procedure,N/A,"{'steps':[{'name':'Check kernel module is not available','type':'script','algorithm':'Null','expected_value':'','pass_stop_check':'True','target_script':'ensure_kernel_module_is_not_available.sh','script_params':['jffs2']},{'name':'Check kernel module is not loaded','type':'command','algorithm':'Null','expected_value':'','command':'lsmod | grep \'jffs2\''},{'name':'Check kernel module is not loadable','type':'command','algorithm':'Contain','expected_value':'blacklist jffs2;install jffs2 /bin/false;install jffs2 /bin/true','command':'modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+jffs2\\b\''}]}",,
1.1.1.9,L1,"Server, Workstation",Initial Setup,Ensure usb-storage kernel module is not available,multi_procedure,N/A,"{'steps':[{'name':'Check kernel module is not available','type':'script','algorithm':'Null','expected_value':'','pass_stop_check':'True','target_script':'ensure_kernel_module_is_not_available.sh','script_params':['usb-storage','drivers']},{'name':'Check kernel module is not loaded','type':'command','algorithm':'Null','expected_value':'','command':'lsmod | grep -P -- \'usb(_|-)storage\''},{'name':'Check kernel module is not loadable','type':'command','algorithm':'Contain','expected_value':'se;install usb_storage /bin/trublacklist usb_storage;install usb_storage /bin/fale','command':' modprobe --showconfig | grep -P -- \'\\b(install|blacklist)\\h+usb_storage\\b\''}]}",,
1.1.2.1.1,L1,"Server, Workstation",Initial Setup,Ensure /tmp is a separate partition,multi_procedure,N/A,"{'steps': [{'name': 'Verify the output shows that /tmp is mounted', 'type': 'command', 'algorithm': 'Contain', 'expected_value': '/tmp   tmpfs  tmpfs  rw,nosuid,nodev,noexec', 'command': 'findmnt -kn /tmp'}, {'name': 'Ensure that systemd will mount the /tmp partition at boot time.', 'type': 'command', 'algorithm': 'Exact', 'expected_value': 'generated', 'command': 'systemctl is-enabled tmp.mount'}]}",Null,
1.1.2.1.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /tmp partition,command_output,findmnt -kn /tmp | grep -v nodev,,Null,
1.1.2.1.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /tmp partition,command_output,findmnt -kn /tmp | grep -v nosuid,,Null,
1.1.2.1.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /tmp partition,command_output,findmnt -kn /tmp | grep -v noexec,,Null,
1.1.2.2.1,L1,"Server, Workstation",Initial Setup,Ensure /dev/shm is a separate partition,command_output,findmnt -kn /dev/shm,,Contain,"/dev/shm   tmpfs  tmpfs  rw,nosuid,nodev,noexec,relatime"
1.1.2.2.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /dev/shm partition,command_output,findmnt -kn /dev/shm | grep -v 'nodev',,Null,
1.1.2.2.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /dev/shm partition,command_output,findmnt -kn /dev/shm | grep -v 'nosuid',,Null,
1.1.2.2.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /dev/shm partition,command_output,findmnt -kn /dev/shm | grep -v 'noexec',,Null,
1.1.2.3.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /home partition,command_output,findmnt -kn /home | grep -v nodev,,Null,
1.1.2.3.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /home partition,command_output,findmnt -kn /home | grep -v nosuid,,Null,
1.1.2.4.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var partition,command_output,findmnt -kn /var | grep -v nodev,,Null,
1.1.2.4.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var partition,command_output,findmnt -kn /var | grep -v nosuid,,Null,
1.1.2.5.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var/tmp partition,command_output,findmnt -kn /var/tmp | grep -v nodev,,Null,
1.1.2.5.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var/tmp partition,command_output,findmnt -kn /var/tmp | grep -v nosuid,,Null,
1.1.2.5.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /var/tmp partition,command_output,findmnt -kn /var/tmp | grep -v noexec,,Null,
1.1.2.6.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var/log partition,command_output,findmnt -kn /var/log | grep -v nodev,,Null,
1.1.2.6.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var/log partition,command_output,findmnt -kn /var/log | grep -v nosuid,,Null,
1.1.2.6.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /var/log partition,command_output,findmnt -kn /var/log | grep -v noexec,,Null,
1.1.2.7.2,L1,"Server, Workstation",Initial Setup,Ensure nodev option set on /var/log/audit partition,command_output,findmnt -kn /var/log/audit | grep -v nodev,,Null,
1.1.2.7.3,L1,"Server, Workstation",Initial Setup,Ensure nosuid option set on /var/log/audit partition,command_output,findmnt -kn /var/log/audit | grep -v nosuid,,Null,
1.1.2.7.4,L1,"Server, Workstation",Initial Setup,Ensure noexec option set on /var/log/audit partition,command_output,findmnt -kn /var/log/audit | grep -v noexec,,Null,
1.3.1.1,L1,"Server, Workstation",Initial Setup,Ensure latest versions of the apparmor packages are installed,multi_procedure,N/A,"{'steps':[{'name':'command to verify that apparmor is installed','type':'command','algorithm':'Exact','expected_value':'apparmor is installed','command':'dpkg-query -s apparmor &>/dev/null && echo \""apparmor is installed\""'},{'name':'command to verify that apparmor-utils is installed','type':'command','algorithm':'Exact','expected_value':'apparmor-utils is installed','command':'dpkg-query -s apparmor-utils &>/dev/null && echo \""apparmor-utils is installed\""'},{'name':'command to verify apparmor is the latest version','type':'command','algorithm':'Null','expected_value':'','command':'apt list --upgradable 2>&1 | grep -P \'^apparmor\\b\''},{'name':'command to verify apparmor-utils is the latest version','type':'command','algorithm':'Null','expected_value':'','command':'apt list --upgradable 2>&1 | grep -P \'^apparmor-utils\\b\''}]}",Null,
1.3.1.2,L1,"Server, Workstation",Initial Setup,Ensure AppArmor is enabled in the bootloader configuration,multi_procedure,N/A,"{'steps':[{'name':'verify that all linux lines have the apparmor=1 parameter set','type':'command','algorithm':'Null','expected_value':'','command':'grep \""^\\s*linux\"" /boot/grub/grub.cfg | grep -v \""apparmor=1\""'},{'name':'verify that all linux lines have the security=apparmor parameter set:','type':'command','algorithm':'Null','expected_value':'','command':'grep \""^\\s*linux\"" /boot/grub/grub.cfg | grep -v \""security=apparmor\""'}]}",Null,
1.4.2,L1,"Server, Workstation",Initial Setup,Ensure access to bootloader config is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)' /boot/grub/grub.cfg,,Exact,Access: (0600/-rw-------)  Uid: ( 0/ root) Gid: ( 0/ root)
1.5.1,L1,"Server, Workstation",Initial Setup,Ensure address space layout randomization is enabled,execute_script,ensure_address_space_layout_randomization_is_enabled.sh,,Contain,PASS
1.5.2,L1,"Server, Workstation",Initial Setup,Ensure ptrace_scope is restricted,execute_script,ensure_ptrace_scope_is_restricted.sh,,Contain,PASS
1.5.4,L1,"Server, Workstation",Initial Setup,Ensure prelink is not installed,command_output,"dpkg-query -s prelink &>/dev/null && echo ""prelink is installed"" ",,Null,
1.5.5,L1,"Server, Workstation",Initial Setup,Ensure Automatic Error Reporting is not enabled,multi_procedure,N/A,"{'steps':[{'name':'verify that the Apport Error Reporting Service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'dpkg-query -s apport &> /dev/null && grep -Psi -- \'^\\h*enabled\\h*=\\h*[^0]\\b\' /etc/default/apport'},{'name':'verify that the apport service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active apport.service | grep \'^active\''}]}",Null,
2.1.1,L1,Server,Services,Ensure autofs services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify autofs is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s autofs &>/dev/null && echo \""autofs is installed\""'},{'name':'verify autofs.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled autofs.service 2>/dev/null | grep \'enabled\''},{'name':'verify the autofs.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active autofs.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.10,L1,"Server, Workstation",Services,Ensure nis server services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify ypserv is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s ypserv &>/dev/null && echo \""ypserv is installed\""'},{'name':'verify ypserv.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled ypserv.service 2>/dev/null | grep \'enabled\''},{'name':'verify the ypserv.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active ypserv.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.11,L1,Server,Services,Ensure print server services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify cups is not Installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s cups &>/dev/null && echo \""cups is installed\""'},{'name':'verify the cups.socket and cups.service are not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled cups.socket cups.service 2>/dev/null | grep \'enabled\''},{'name':'verify the cups.socket and cups.service are not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active cups.socket cups.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.12,L1,"Server, Workstation",Services,Ensure rpcbind services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify rpcbind package is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s rpcbind &>/dev/null && echo \""rpcbind is installed\""'},{'name':'verify rpcbind.socket and rpcbind.service are not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled rpcbind.socket rpcbind.service 2>/dev/null | grep \'enabled\''},{'name':'verify rpcbind.socket and rpcbind.service are not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active rpcbind.socket rpcbind.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.13,L1,"Server, Workstation",Services,Ensure rsync services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify rsync is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s rsync &>/dev/null && echo \""rsync is installed\""'},{'name':'verify rsync.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled rsync.service 2>/dev/null | grep \'enabled\''},{'name':'verify rsync.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active rsync.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.14,L1,"Server, Workstation",Services,Ensure samba file server services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify samba is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s samba &>/dev/null && echo \""samba is installed\""'},{'name':'verify smbd.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled smbd.service 2>/dev/null | grep \'enabled\''},{'name':'verify the smbd.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active smbd.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.15,L1,"Server, Workstation",Services,Ensure snmp services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify snmpd is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s snmpd &>/dev/null && echo \""snmpd is installed\""'},{'name':'verify the snmpd.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled snmpd.service 2>/dev/null | grep \'enabled\''},{'name':'verify the snmpd.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active snmpd.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.16,L1,"Server, Workstation",Services,Ensure tftp server services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify tftpd-hpa is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s tftpd-hpa &>/dev/null && echo \""tftpd-hpa is installed\""'},{'name':'verify tftpd-hpa.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled tftpd-hpa.service 2>/dev/null | grep \'enabled\''},{'name':'verify the tftpd-hpa.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active tftpd-hpa.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.19,L1,"Server, Workstation",Services,Ensure xinetd services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify the xinetd package is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s xinetd &>/dev/null && echo \""xinetd is installed\""'},{'name':' verify xinetd.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled xinetd.service 2>/dev/null | grep \'enabled\''},{'name':'verify xinetd.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active xinetd.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.2,L1,Server,Services,Ensure avahi daemon services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify avahi-daemon is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s avahi-daemon &>/dev/null && echo \""avahi-daemon is installed\""'},{'name':'verify avahi-daemon.socket and avahi-daemon.service are not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled avahi-daemon.socket avahi-daemon.service 2>/dev/null | grep \'enabled\''},{'name':'verify avahi-daemon.socket and avahi-daemon.service are not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active avahi-daemon.socket avahi-daemon.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.21,L1,"Server, Workstation",Services,Ensure mail transfer agents are configured for local-only mode,execute_script,ensure_mail_transfer_agents_are_configured_for_localonly_mode.sh,,Contain,PASS
2.1.3,L1,"Server, Workstation",Services,Ensure dhcp server services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify isc-dhcp-server is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s isc-dhcp-server &>/dev/null && echo \""isc-dhcp-server is installed\""'},{'name':'verify isc-dhcp-server.service and isc-dhcp-server6.service are not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled isc-dhcp-server.service isc-dhcp-server6.service 2>/dev/null | grep \'enabled\''},{'name':'verify isc-dhcp-server.service and isc-dhcp-server6.service are not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active isc-dhcp-server.service isc-dhcp-server6.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.4,L1,"Server, Workstation",Services,Ensure dns server services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify bind9 is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s bind9 &>/dev/null && echo \""bind9 is installed\""'},{'name':'verify named.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled named.service 2>/dev/null | grep \'enabled\''},{'name':'verify the named.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active named.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.5,L1,"Server, Workstation",Services,Ensure dnsmasq services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify dnsmasq is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s dnsmasq &>/dev/null && echo \""dnsmasq is installed\""'},{'name':'verify dnsmasq.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled dnsmasq.service 2>/dev/null | grep \'enabled\''},{'name':'verify the dnsmasq.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active dnsmasq.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.6,L1,"Server, Workstation",Services,Ensure ftp server services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify vsftpd is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s vsftpd &>/dev/null && echo \""vsftpd is installed\""'},{'name':'vsftpd service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled vsftpd.service 2>/dev/null | grep \'enabled\''},{'name':'verify the vsftpd service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active vsftpd.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.7,L1,"Server, Workstation",Services,Ensure ldap server services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify slapd is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s slapd &>/dev/null && echo \""slapd is installed\""'},{'name':'verify slapd.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled slapd.service 2>/dev/null | grep \'enabled\''},{'name':'verify slapd.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active slapd.service 2>/dev/null | grep \'^active\''}]}",Null,
2.1.9,L1,"Server, Workstation",Services,Ensure network file system services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify nfs-kernel-server is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s nfs-kernel-server &>/dev/null && echo \""nfs-kernel-server is installed\""'},{'name':'verify that the nfs-server.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled nfs-server.service 2>/dev/null | grep \'enabled\''},{'name':'verify the nfs-server.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active nfs-server.service 2>/dev/null | grep \'^active\''}]}",Null,
2.2.1,L1,"Server, Workstation",Services,Ensure nis client is not installed,command_output,"dpkg-query -s nis &>/dev/null && echo ""nis is installed""",,Null,
2.2.2,L1,"Server, Workstation",Services,Ensure rsh client is not installed,command_output,"dpkg-query -s rsh-client &>/dev/null && echo ""rsh-client is installed""",,Null,
2.2.3,L1,"Server, Workstation",Services,Ensure talk client is not installed,command_output,"dpkg-query -s talk &>/dev/null && echo ""talk is installed""",,Null,
2.2.4,L1,"Server, Workstation",Services,Ensure telnet client is not installed,command_output,"dpkg-query -s telnet &>/dev/null && echo ""telnet is installed""",,Null,
2.2.5,L1,"Server, Workstation",Services,Ensure ldap client is not installed,command_output,"dpkg-query -s ldap-utils &>/dev/null && echo ""ldap-utils is installed""",,Null,
2.2.6,L1,"Server, Workstation",Services,Ensure ftp client is not installed,command_output,"dpkg-query -s ftp &>/dev/null && echo ""ftp is installed""",,Null,
2.4.2.1,L1,"Server, Workstation",Services,Ensure access to at is configured,multi_procedure,N/A,"{'steps':[{'name':' verify /etc/at.allow','type':'command','algorithm':'Exact','expected_value':'Access: (640/-rw-r-----) Owner: (root) Group: (daemon);Access: (640/-rw-r-----) Owner: (root) Group: (root)','command':'stat -Lc \'Access: (%a/%A) Owner: (%U) Group: (%G)\' /etc/at.allow'},{'name':'verify at.deny doesn\'t exist, -OR- is','type':'command','algorithm':'Exact','expected_value':'Access: (640/-rw-r-----) Owner: (root) Group: (daemon);Access: (640/-rw-r-----) Owner: (root) Group: (root);  ','command':'[ -e \""/etc/at.deny\"" ] && stat -Lc \'Access: (%a/%A) Owner: (%U) Group: (%G)\' /etc/at.deny'}]}",Null,
3.1.2,L1,Server,Network,Ensure wireless interfaces are not available,execute_script,ensure_wireless_intrfaces_are_not_availabe.sh,,Contain,PASS
3.1.3,L1,Server,Network,Ensure bluetooth services are not in use,multi_procedure,N/A,"{'steps':[{'name':'verify the bluez package is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s bluez &>/dev/null && echo \""bluez is installed\"" '},{'name':'verify bluetooth.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled bluetooth.service 2>/dev/null | grep \'enabled\''},{'name':'verify bluetooth.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active bluetooth.service 2>/dev/null | grep \'^active\''}]}",Null,
3.3.1,L1,"Server, Workstation",Network,Ensure ip forwarding is disabled,execute_script,kernel_config_parameter.sh,"['net.ipv4.ip_forward=0','net.ipv6.conf.all.forwarding=0']",Contain,PASS
3.3.10,L1,"Server, Workstation",Network,Ensure tcp syn cookies is enabled,execute_script,kernel_config_parameter.sh,['net.ipv4.tcp_syncookies=1'],Contain,PASS
3.3.11,L1,"Server, Workstation",Network,Ensure ipv6 router advertisements are not accepted,execute_script,kernel_config_parameter.sh,"['net.ipv6.conf.all.accept_ra=0','net.ipv6.conf.default.accept_ra=0']",Contain,PASS
3.3.2,L1,"Server, Workstation",Network,Ensure packet redirect sending is disabled,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.send_redirects=0','net.ipv4.conf.default.send_redirects=0']",Contain,PASS
3.3.3,L1,"Server, Workstation",Network,Ensure bogus icmp responses are ignored,execute_script,kernel_config_parameter.sh,['net.ipv4.icmp_ignore_bogus_error_responses=1'],Contain,PASS
3.3.4,L1,"Server, Workstation",Network,Ensure broadcast icmp requests are ignored,execute_script,kernel_config_parameter.sh,['net.ipv4.icmp_echo_ignore_broadcasts=1'],Contain,PASS
3.3.5,L1,"Server, Workstation",Network,Ensure icmp redirects are not accepted,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.accept_redirects=0','net.ipv4.conf.default.accept_redirects=0','net.ipv6.conf.all.accept_redirects=0','net.ipv6.conf.default.accept_redirects=0']",Contain,PASS
3.3.6,L1,"Server, Workstation",Network,Ensure secure icmp redirects are not accepted,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.secure_redirects=0','net.ipv4.conf.default.secure_redirects=0']",Contain,PASS
3.3.7,L1,"Server, Workstation",Network,Ensure reverse path filtering is enabled,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.rp_filter=1','net.ipv4.conf.default.rp_filter=1']",Contain,PASS
3.3.8,L1,"Server, Workstation",Network,Ensure source routed packets are not accepted,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.accept_source_route=0','net.ipv4.conf.default.accept_source_route=0','net.ipv6.conf.all.accept_source_route=0','net.ipv6.conf.default.accept_source_route=0']",Contain,PASS
3.3.9,L1,"Server, Workstation",Network,Ensure suspicious packets are logged,execute_script,kernel_config_parameter.sh,"['net.ipv4.conf.all.log_martians=1','net.ipv4.conf.default.log_martians=1']",Contain,PASS
4.1.1,L1,"Server, Workstation",Host Based Firewall,Ensure a single firewall configuration utility is in use,execute_script,ensure_a_single_firewall_configuration_utility_is_in_use.sh,,Contain,PASS
4.2.1,L1,"Server, Workstation",Host Based Firewall,Ensure ufw is installed,command_output,"dpkg-query -s ufw &>/dev/null && echo ""ufw is installed""",,Exact,ufw is installed
4.2.2,L1,"Server, Workstation",Host Based Firewall,Ensure nftables is not in use with ufw,multi_procedure,N/A,"{'steps':[{'name':'verify that nftables is not installed','type':'command','algorithm':'Null','expected_value':'','pass_stop_check':'True','command':'dpkg-query -s nftables &>/dev/null && echo \""nftables is installed\""'},{'name':'verify nftables.service is not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled nftables.service 2>/dev/null | grep \'^enabled\''},{'name':'verify nftables.service is not active','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active nftables.service 2>/dev/null | grep \'^active\''}]}",Null,
4.2.3,L1,"Server, Workstation",Host Based Firewall,Ensure iptables-persistent is not installed with ufw,command_output,"dpkg-query -s iptables-persistent &>/dev/null && echo ""iptables-persistent is installed""",,Null,
4.2.4,L1,"Server, Workstation",Host Based Firewall,Ensure ufw service is enabled,multi_procedure,N/A,"{'steps':[{'name':'verify that the ufw daemon is enabled','type':'command','algorithm':'Exact','expected_value':'enabled','command':'systemctl is-enabled ufw.service'},{'name':'verify that the ufw daemon is active','type':'command','algorithm':'Exact','expected_value':'active','command':'systemctl is-active ufw'},{'name':'verify ufw is active','type':'command','algorithm':'Exact','expected_value':'Status: active','command':'ufw status'},{'name':'','type':'command','algorithm':'Null','expected_value':'','command':''}]}",Null,
4.2.7,L1,"Server, Workstation",Host Based Firewall,Ensure ufw firewall rules exist for all open ports,execute_script,ensure_ufw_firewall_rules_exist_for_all_open_ports.sh,,Contain,PASS
5.1.1,L1,"Server, Workstation",Access Control,Ensure access to /etc/ssh/sshd_config is configured,execute_script,ensure_acces_to_etcsshsshd_config_is_configured.sh,,Contain,PASS
5.2.1,L1,"Server, Workstation","Access, Authentication and Authorization",Ensure sudo is installed,multi_procedure,N/A,"{'steps':[{'name':'verify that either sudo is installed','type':'command','algorithm':'Exact','expected_value':'sudo is installed','pass_stop_check':'True','command':'dpkg-query -s sudo &>/dev/null && echo \""sudo is installed\""'},{'name':'verify that either sudo-ldap is installed','type':'command','algorithm':'Exact','expected_value':'sudo-ldap is installed','command':'dpkg-query -s sudo-ldap &>/dev/null && echo \""sudo-ldap is installed\""'}]}",Null,
5.2.2,L1,"Server, Workstation",Access Control,Ensure sudo commands use pty,multi_procedure,N/A,"{'steps':[{'name':' verify Defaults use_pty is se','type':'command','algorithm':'Exact','expected_value':'/etc/sudoers:Defaults    use_pty','command':'grep -rPi -- \'^\\h*Defaults\\h+([^#\\n\\r]+,\\h*)?use_pty\\b\' /etc/sudoers*'},{'name':'verify Defaults !use_pty is not set','type':'command','algorithm':'Null','expected_value':'','command':'grep -rPi -- \'^\\h*Defaults\\h+([^#\\n\\r]+,\\h*)?!use_pty\\b\' /etc/sudoers*'}]}",Null,
5.2.3,L1,"Server, Workstation",Access Control, Ensure sudo log file exists,command_output,"grep -rPsi ""^\h*Defaults\h+([^#]+,\h*)?logfile\h*=\h*(\""|\')?\H+(\""|\')?(,\h*\H+\h*)*\h*(#.*)?$"" /etc/sudoers*",,Exact,"Defaults logfile=""/var/log/sudo.log"""
5.2.4,L1,"Server, Workstation",Access Control,Ensure users must provide password for privilege escalation,command_output,"grep -r ""^[^#].*NOPASSWD"" /etc/sudoers*",,Null,
6.1.1,L1,"Server, Workstation",Logging and Auditing,Ensure AIDE is installed,multi_procedure,N/A,"{'steps':[{'name':'verify aide is installed','type':'command','algorithm':'Exact','expected_value':'aide is installed','command':'dpkg-query -s aide &>/dev/null && echo \""aide is installed\""'},{'name':'verify aide-common is installed','type':'command','algorithm':'Exact','expected_value':'aide-common is installed','command':'dpkg-query -s aide-common &>/dev/null && echo \""aide-common is installed\""'}]}",Null,
6.1.2,L1,"Server, Workstation",Logging and Auditing,Ensure filesystem integrity is regularly checked,multi_procedure,N/A,"{'steps':[{'name':'Check if dailyaidecheck.service is either static or enabled','type':'command','algorithm':'Contain','expected_value':'enabled;static','command':'systemctl list-unit-files | awk \'$1~/^dailyaidecheck\\.(service)$/{print $1 \""\\t\"" $2}\''},{'name':'Checking if dailyaidecheck.timer enabled','type':'command','algorithm':'Contain','expected_value':'enabled','command':'systemctl list-unit-files | awk \'$1~/^dailyaidecheck\\.(timer)$/{print $1 \""\\t\"" $2}\''},{'name':'verify dailyaidecheck.timer is active','type':'command','algorithm':'Exact','expected_value':'active','command':'systemctl is-active dailyaidecheck.timer'}]}",Null,
5.1.2,L1,"Server, Workstation",Access Control,Ensure access to SSH private host key files is configured,execute_script,ensure_access_to_SSH_private_host_key_files_is_configured.sh,,Contain,PASS
5.1.3,L1,"Server, Workstation",Access Control,Ensure access to SSH public host key files is configured,execute_script,ensure_access_to_SSH_public_host_key_files_is_configured.sh,,Contain,PASS
5.2.5,L1,"Server, Workstation",Access Control,Ensure re-authentication for privilege escalation is not disabled globally,command_output,"grep -r ""^[^#].*\!authenticate"" /etc/sudoers*",,Null,
5.3.1.1,L1,"Server, Workstation",Access Control,Ensure latest version of pam is installed,multi_procedure,N/A,"{'steps':[{'name':'verify libpam-runtime is installed','type':'command','algorithm':'Exact','expected_value':'libpam-runtime is installed','command':'dpkg-query -s libpam-runtime &>/dev/null && echo \""libpam-runtime is installed\""'},{'name':'verify libpam-runtime is the latest version','type':'command','algorithm':'Null','expected_value':'','command':'apt list --upgradable 2>&1 | grep -P \'^libpam-runtime\\b\''}]}",Null,
5.3.1.2,L1,"Server, Workstation",Access Control,Ensure latest version of libpam-modules is installed,multi_procedure,N/A,"{'steps':[{'name':'verify libpam-modules is installed','type':'command','algorithm':'Exact','expected_value':'libpam-modules is installed','command':'dpkg-query -s libpam-modules &>/dev/null && echo \""libpam-modules is installed\""'},{'name':'verify libpam-modules is the latest version','type':'command','algorithm':'Null','expected_value':'','command':'apt list --upgradable 2>&1 | grep -P \'^libpam-modules\\b\''}]}",Null,
5.3.1.3,L1,"Server, Workstation",Access Control,Ensure latest version of libpam-pwquality is installed,multi_procedure,N/A,"{'steps':[{'name':'verify libpam-pwquality is installed','type':'command','algorithm':'Exact','expected_value':'libpam-pwquality is installed','command':'dpkg-query -s libpam-pwquality &>/dev/null && echo \""libpam-pwquality is installed\""'},{'name':'verify libpam-pwquality is the latest version','type':'command','algorithm':'Null','expected_value':'','command':'apt list --upgradable 2>&1 | grep -P \'^libpam-pwquality\\b\''}]}",Null,
5.3.2.1,L1,"Server, Workstation",Access Control,Ensure pam_unix module is enabled,command_output,"grep -PH -- '\bpam_unix\.so\b' /etc/pam.d/common-{account,auth,password,session,session-noninteractive}",,Contain,/etc/pam.d/common-account:account   [success=1 new_authtok_reqd=done default=ignore]   pam_unix.so /etc/pam.d/common-auth:auth   [success=2 default=ignore]   pam_unix.so try_first_pass /etc/pam.d/common-password:password   [success=1 default=ignore]   pam_unix.so obscure use_authtok try_first_pass yescrypt /etc/pam.d/common-session:session   required   pam_unix.so /etc/pam.d/common-session-noninteractive:session   required   pam_unix.so
5.4.1.1,L1,"Server, Workstation",Access Control,Ensure password expiration is configured,command_output,"awk -F: '($2~/^\$.+\$/) {if($5 > 365 || $5 < 1)print ""User: "" $1 "" PASS_MAX_DAYS: "" $5}' /etc/shadow",,Null,
5.4.1.2,L1,"Server, Workstation",Access Control,Ensure minimum password days is configured,command_output,"awk -F: '($2~/^\$.+\$/) {if($4 < 1)print ""User: "" $1 "" PASS_MIN_DAYS: "" $4}' /etc/shadow",,Null,
5.4.1.3,L1,"Server, Workstation",Access Control,Ensure password expiration warning days is configured,command_output,"awk -F: '($2~/^\$.+\$/) {if($6 < 7)print ""User: "" $1 "" PASS_WARN_AGE: "" $6}' /etc/shadow",,Null,
5.4.1.4,L1,"Server, Workstation",Access Control,Ensure strong password hashing algorithm is configured,command_output,grep -Pi -- '^\h*ENCRYPT_METHOD\h+(SHA512|yescrypt)\b' /etc/login.defs,,Exact,ENCRYPT_METHOD SHA512;ENCRYPT_METHOD  YESCRYPT
5.4.1.5,L1,"Server, Workstation",Access Control,Ensure inactive password lock is configured,command_output,"awk -F: '($2~/^\$.+\$/) {if($7 > 45 || $7 < 0)print ""User: "" $1 "" INACTIVE: "" $7 ""Days""}' /etc/shadow",,Null,
5.4.1.6,L1,"Server, Workstation",Access Control,Ensure all users last password change date is in the past,execute_script,ensure_all_users_last_password_change_date_is_in_the_past.sh,,Null,
5.4.2.1,L1,"Server, Workstation",Access Control,Ensure root is the only UID 0 account,command_output,awk -F: '($3 == 0) { print $1 }' /etc/passwd,,Exact,root
5.4.2.2,L1,"Server, Workstation",Access Control,Ensure root is the only GID 0 account,command_output,"awk -F: '($1 !~ /^(sync|shutdown|halt|operator)/ && $4==""0"") {print $1"":""$4}' /etc/passwd",,Exact,root:0
5.4.2.3,L1,"Server, Workstation",Access Control,Ensure group root is the only GID 0 group,command_output,"awk -F: '$3==""0""{print $1"":""$3}' /etc/group",,Exact,root:0
5.4.2.4,L1,"Server, Workstation",Access Control,Ensure root account access is controlled,command_output,"passwd -S root | awk '$2 ~ /^(P|L)/ {print $1"":""$2}'",,Exact,root:P;root:L
5.4.2.5,L1,"Server, Workstation",Access Control,Ensure root path integrity,execute_script,ensure_root_path_integrity.sh,,Contain,PASS
5.4.2.6,L1,"Server, Workstation",Access Control,Ensure root user umask is configured,command_output,"grep -Psi -- '^\h*umask\h+(([0-7][0-7][01][0-7]\b|[0-7][0-7][0-7][0-6]\b)|([0-7][01][0-7]\b|[0-7][0-7][0-6]\b)|(u=[rwx]{1,3},)?(((g=[rx]?[rx]?w[rx]?[rx]?\b)(,o=[rwx]{1,3})?)|((g=[wrx]{1,3},)?o=[wrx]{1,3}\b)))' /root/.bash_profile /root/.bashrc /etc/login.defs",,Null,
5.4.2.7,L1,"Server, Workstation",Access Control,Ensure system accounts do not have a valid login shell,execute_script,ensure_system_accounts_do_not_have_a_valid_login_shell.sh,,Null,
5.4.2.8,L1,"Server, Workstation",Access Control,Ensure accounts without a valid login shell are locked,execute_script,ensure_accounts_without_a_valid_login_shell_are_locked.sh,,Null,
5.4.3.2,L1,"Server, Workstation",Access Control,Ensure default user shell timeout is configured,execute_script,ensure_default_user_shell_timeout_is_configured.sh,,Contain,PASS
5.4.3.3,L1,"Server, Workstation",Access Control,Ensure default user umask is configured,execute_script,ensure_default_user_unmask_is_configured.sh,,Contain,PASS
6.2.1.1,L1,"Server, Workstation",Logging and Auditing,Ensure journald service is enabled and active,multi_procedure,N/A,"{'steps':[{'name':'verify systemd-journald is enabled','type':'command','algorithm':'Exact','expected_value':'static','pass_stop_check':'True','command':'systemctl is-enabled systemd-journald.service'},{'name':'verify systemd-journald is active','type':'command','algorithm':'Exact','expected_value':'active','command':'systemctl is-active systemd-journald.service'}]}",Null,
6.2.1.2,L1,"Server, Workstation",Logging and Auditing,Ensure journald log file access is configured,execute_script,ensure_journald_log_file_access_is_configured.sh,,Contain,PASS
6.2.1.3,L1,"Server, Workstation",Logging and Auditing,Ensure journald log file rotation is configured,execute_script,ensure_journald_log_file_rotation_is_configured.sh,,Contain,PASS
6.2.2.1.1,L1,"Server, Workstation",Logging and Auditing,Ensure systemd-journal-remote is installed,command_output,"dpkg-query -s systemd-journal-remote &>/dev/null && echo ""systemd-journal-remote is installed"" ",,Exact,systemd-journal-remote is installed
6.2.2.1.3,L1,"Server, Workstation",Logging and Auditing,Ensure systemd-journal-upload is enabled and active,multi_procedure,N/A,"{'steps':[{'name':'verify systemd-journal-upload is enabled','type':'command','algorithm':'Exact','expected_value':'enabled','command':'systemctl is-enabled systemd-journal-upload.service'},{'name':'verify systemd-journal-upload is active','type':'command','algorithm':'Exact','expected_value':'active','command':'systemctl is-active systemd-journal-upload.service'}]}",Null,
6.2.2.1.4,L1,"Server, Workstation",Logging and Auditing,Ensure systemd-journal-remote service is not in use,multi_procedure,N/A,"{'steps':[{'name':'verify systemd-journal-remote.socket and systemd-journal-remote.service are not enabled','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-enabled systemd-journal-remote.socket systemd-journal-remote.service | grep -P -- \'^enabled\''},{'name':'verify systemd-journal-remote.socket and systemd-journal-remote.service are not active:','type':'command','algorithm':'Null','expected_value':'','command':'systemctl is-active systemd-journal-remote.socket systemd-journal-remote.service | grep -P -- \'^active\''}]}",Null,
6.2.2.2,L1,"Server, Workstation",Logging and Auditing,Ensure journald ForwardToSyslog is disabled,command_output,"grep -Psi ""^ForwardToSyslog=no"" /etc/systemd/journald.conf /etc/systemd/journald.conf.d/*",,Exact,ForwardToSyslog=no
6.2.2.3,L1,"Server, Workstation",Logging and Auditing,Ensure journald Compress is configured,command_output,"grep -Psi ""^Compress=yes"" /etc/systemd/journald.conf /etc/systemd/journald.conf.d/*",,Exact,Compress=yes
6.2.2.4,L1,"Server, Workstation",Logging and Auditing,Ensure journald Storage is configured,command_output,"grep -Psi ""^Storage=persistent"" /etc/systemd/journald.conf /etc/systemd/journald.conf.d/*",,Exact,Storage=persistent
6.2.4.1,L1,"Server, Workstation",Logging and Auditing,Ensure access to all logfiles has been configured,execute_script,ensure_access_to_all_logfiles_has_been_configured.sh,,Contain,PASS
7.1.1,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/passwd is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/passwd,,Exact,Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.2,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/passwd- is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: { %g/ %G)' /etc/passwd-,,Exact,Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: { 0/ root)
7.1.3,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/group is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/group,,Exact,Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.4,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/group- is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/group-,,Exact,Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.5,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/shadow is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/shadow,,Exact,Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 42/ shadow);Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.6,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/shadow- is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/shadow-,,Exact,Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 42/ shadow);Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.7,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/gshadow is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/gshadow,,Exact,Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 42/ shadow);Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.8,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/gshadow- is configured,command_output, stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/gshadow-,,Exact,Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 42/ shadow);Access: (0640/-rw-r-----)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.9,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/shells is configured,command_output,stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/shells,,Exact,Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)
7.1.10,L1,"Server, Workstation",System Maintenance,Ensure access to /etc/security/opasswd is configured,multi_procedure,N/A,"{'steps':[{'name':'verify /etc/security/opasswd are mode 600 or more restrictive, Uid is 0/root and Gid is 0/root if they exist','type':'command','algorithm':'Exact','expected_value':'/etc/security/opasswd Access: (0600/-rw-------)  Uid: ( 0/ root) Gid: ( 0/ root); ','command':'[ -e \""/etc/security/opasswd\"" ] && stat -Lc \'%n Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)\' /etc/security/opasswd'},{'name':'/etc/security/opasswd.old are mode 600 or more restrictive, Uid is 0/root and Gid is 0/root if they exist','type':'command','algorithm':'Exact','expected_value':'/etc/security/opasswd.old Access: (0600/-rw-------)  Uid: ( 0/ root) Gid: ( 0/ root); ','command':'[ -e \""/etc/security/opasswd.old\"" ] && stat -Lc \'%n Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)\' /etc/security/opasswd.old'}]}",Null,
7.1.11,L1,"Server, Workstation",System Maintenance,Ensure world writable files and directories are secured,execute_script,ensure_world_writable_files_and_directories_are_secured.sh,,Contain,PASS
7.1.12,L1,"Server, Workstation",System Maintenance,Ensure no files or directories without an owner and a group exist,execute_script,ensure_no_files_or_directories_without_an_owner_and_a_group_exist.sh,,Contain,PASS
7.2.1,L1,"Server, Workstation",System Maintenance,Ensure accounts in /etc/passwd use shadowed passwords,command_output,"awk -F: '($2 != ""x"" ) { print ""User: \"""" $1 ""\"" is not set to shadowed passwords ""}' /etc/passwd",,Null,
7.2.2,L1,"Server, Workstation",System Maintenance,Ensure /etc/shadow password fields are not empty,command_output,"awk -F: '($2 == """" ) { print $1 "" does not have a password ""}' /etc/shadow",,Null,
7.2.3,L1,"Server, Workstation",System Maintenance,Ensure all groups in /etc/passwd exist in /etc/group,execute_script,ensure_all_groups_in_etcpasswd_exist_in_etcgroup.sh,,Null,
7.2.4,L1,"Server, Workstation",System Maintenance,Ensure shadow group is empty,multi_procedure,N/A,"{'steps':[{'name':'Check group permission right access to shadow file','type':'command','algorithm':'Null','expected_value':'','command':'awk -F: \'($1==\""shadow\"") {print $NF}\' /etc/group'},{'name':'Check users subvert accounts permission right access to shadow file','type':'command','algorithm':'Null','expected_value':'','command':'awk -F: \'($4 == \'\""$(getent group shadow | awk -F: \'{print $3}\' | xargs)\""\') {print \""  - user: \\\""\"" $1 \""\\\"" primary group is the shadow group\""}\' /etc/passwd'}]}",Null,
7.2.5,L1,"Server, Workstation",System Maintenance,Ensure no duplicate UIDs exist,execute_script,ensure_no_duplicate_UIDs_exist.sh,,Null,
7.2.6,L1,"Server, Workstation",System Maintenance,Ensure no duplicate GIDs exist,execute_script,ensure_no_duplicate_GIDs_exist.sh,,Null,
7.2.7,L1,"Server, Workstation",System Maintenance,Ensure no duplicate user names exist,execute_script,ensure_no_duplicate_user_names_exist.sh,,Null,
7.2.8,L1,"Server, Workstation",System Maintenance,Ensure no duplicate group names exist,execute_script,ensure_no_duplicate_group_names_exist.sh,,Null,
7.2.9,L1,"Server, Workstation",System Maintenance,Ensure local interactive user home directories are configured,execute_script,ensure_local_interactive_user_home_directories_are_configured.sh,,Contain,PASS
7.2.10,L1,"Server, Workstation",System Maintenance,Ensure local interactive user dot files access is configured,execute_script,ensure_local_interactive_user_dot_files_access_is_configured.sh,,Contain,PASS
1.3.1.3,L1,"Server, Workstation",Initial Setup,Ensure all AppArmor Profiles are not disabled,multi_procedure,N/A,"{'steps':[{'name':'verify that profiles are loaded, and are in either enforce or complain mode','type':'command','algorithm':'Exact','expected_value':'PASS','command':'sudo apparmor_status | grep profiles | awk \'/profiles are loaded/{l=$1} /enforce mode/{e=$1} /complain mode/{c=$1} END{print (l>0 && e+c==l) ? \""PASS\"" : \""FAIL\""}\''},{'name':'ensure no processes are unconfined','type':'command','algorithm':'Exact','expected_value':'PASS','command':'sudo apparmor_status | grep processes | awk \'/processes are unconfined/{unc=$1} END{print (unc==0) ? \""PASS\"" : \""FAIL\""}\''}]}",Null,
1.5.3,L1,"Server, Workstation",Initial Setup,Ensure core dumps are restricted,multi_procedure,N/A,"{'steps':[{'name':'Checking file set','type':'command','algorithm':'Contain','expected_value':'hard core 0','command':''},{'name':'Check Kernel load','type':'script','algorithm':'Contain','expected_value':'PASS','target_script':'ensure_core_dumps_are_restricted_check1_kernel_parameter.sh','script_params':[]},{'name':'Check systemd-coredump configured ','type':'script','algorithm':'Contain','expected_value':'PASS','target_script':'ensure_core_dumps_are_restricted_check2_if_coredump_installed.sh','script_params':[]}]}",Null,